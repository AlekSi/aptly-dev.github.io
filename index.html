<!DOCTYPE html>
<html>
  <head>
    <title>aptly - Debian repository management tool</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Bootstrap -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/aptly.css" rel="stylesheet">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <link rel="icon" type="image/png" href="favicon-16x16.png" sizes="16x16">
    <link rel="icon" type="image/png" href="favicon-32x32.png" sizes="32x32">
  </head>
  <body data-spy="scroll" data-target=".navbar-default">
    <!-- Fixed navbar -->
    <div class="navbar navbar-default navbar-fixed-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#"><img src="favicon-16x16.png" alt="aptly logo"> aptly</a>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav navbar-right">
            <li><a href="https://github.com/smira/aptly/">GitHub</a></li>
            <li><a href="#examples">Examples</a></li>
            <li><a href="#download">Download</a></li>
            <li><a href="#usage">Usage</a></li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">mirror <b class="caret"></b></a>
              <ul class="dropdown-menu">
                <li><a href="#aptly-mirror-create">aptly mirror create</a></li>
                <li><a href="#aptly-mirror-update">aptly mirror update</a></li>
                <li><a href="#aptly-mirror-list">aptly mirror list</a></li>
                <li><a href="#aptly-mirror-show">aptly mirror show</a></li>
                <li><a href="#aptly-mirror-drop">aptly mirror drop</a></li>
              </ul>
            </li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">repo <b class="caret"></b></a>
              <ul class="dropdown-menu">
                <li><a href="#aptly-repo-create">aptly repo create</a></li>
                <li><a href="#aptly-repo-add">aptly repo add</a></li>
                <li><a href="#aptly-repo-import">aptly repo import</a></li>
                <li><a href="#aptly-repo-show">aptly repo show</a></li>
                <li><a href="#aptly-repo-list">aptly repo list</a></li>
                <li><a href="#aptly-repo-copy">aptly repo copy</a></li>
                <li><a href="#aptly-repo-move">aptly repo move</a></li>
                <li><a href="#aptly-repo-remove">aptly repo remove</a></li>
                <li><a href="#aptly-repo-edit">aptly repo edit</a></li>
                <li><a href="#aptly-repo-drop">aptly repo drop</a></li>
              </ul>
            </li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">snapshot  <b class="caret"></b></a>
              <ul class="dropdown-menu">
                <li><a href="#aptly-snapshot-create">aptly snapshot create</a></li>
                <li><a href="#aptly-snapshot-list">aptly snapshot list</a></li>
                <li><a href="#aptly-snapshot-show">aptly snapshot show</a></li>
                <li><a href="#aptly-snapshot-verify">aptly snapshot verify</a></li>
                <li><a href="#aptly-snapshot-pull">aptly snapshot pull</a></li>
                <li><a href="#aptly-snapshot-diff">aptly snapshot diff</a></li>
                <li><a href="#aptly-snapshot-merge">aptly snapshot merge</a></li>
                <li><a href="#aptly-snapshot-drop">aptly snapshot drop</a></li>
              </ul>
            </li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">publish <b class="caret"></b></a>
              <ul class="dropdown-menu">
                <li><a href="#aptly-publish-snapshot">aptly publish snapshot</a></li>
                <li><a href="#aptly-publish-repo">aptly publish repo</a></li>
                <li><a href="#aptly-publish-update">aptly publish update</a></li>
                <li><a href="#aptly-publish-switch">aptly publish switch</a></li>
                <li><a href="#aptly-publish-list">aptly publish list</a></li>
                <li><a href="#aptly-publish-drop">aptly publish drop</a></li>
              </ul>
            </li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">other <b class="caret"></b></a>
              <ul class="dropdown-menu">
                <li class="dropdown-header">db</li>
                <li><a href="#aptly-db-cleanup">aptly db cleanup</a></li>
                <li><a href="#aptly-db-info">aptly db info</a></li>
                <li class="divider"></li>
                <li class="dropdown-header">misc</li>
                <li><a href="#aptly-serve">aptly serve</a></li>
                <li><a href="#aptly-graph">aptly graph</a></li>
              </ul>
            </li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </div>

    <div class="container">


      <div class="jumbotron">
        <h1><img src="logo.png" alt="aptly logo">  aptly</h1>

        <p>aptly is a swiss army knife for Debian repository management: it allows to mirror remote
        repositories, manage local package repositories, take snapshots, pull new versions of packages
        along with dependencies, publish snapshots as Debian repositories.</p>

        <p>aptly is free <a href="https://github.com/smira/aptly">open-source</a> software licensed under MIT license.</p>

        <div id="carousel-ss" class="carousel slide" data-ride="carousel">
          <!-- Indicators -->
          <ol class="carousel-indicators">
            <li data-target="#carousel-ss" data-slide-to="0" class="active"></li>
            <li data-target="#carousel-ss" data-slide-to="1"></li>
            <li data-target="#carousel-ss" data-slide-to="2"></li>
            <li data-target="#carousel-ss" data-slide-to="3"></li>
            <li data-target="#carousel-ss" data-slide-to="4"></li>
            <li data-target="#carousel-ss" data-slide-to="5"></li>
          </ol>

          <!-- Wrapper for slides -->
          <div class="carousel-inner">
            <div class="item active">
              <img src="1.png" class="img-responsive" alt="aptly snapshot diff">
              <div class="carousel-caption">
                <h3>Difference between snapshots</h3>
                <p>aptly snapshot diff matches package versions in snapshots</p>
              </div>
            </div>
            <div class="item">
              <img src="2.png" class="img-responsive" alt="aptly snapshot pull">
              <div class="carousel-caption">
                <h3>Pulling packages</h3>
                <p>Pull from snapshot to selectively upgrade packages</p>
              </div>
            </div>
            <div class="item">
              <img src="3.png" class="img-responsive" alt="aptly mirror update">
              <div class="carousel-caption">
                <h3>Mirroring remote repos</h3>
                <p>Download packages from remote mirror to take stable snapshot</p>
              </div>
            </div>
            <div class="item">
              <img src="aptlylocal.png" class="img-responsive" alt="aptly repo">
              <div class="carousel-caption">
                <h3>Managing local repos</h3>
                <p>Create, import and move packages in local package repositories</p>
              </div>
            </div>
            <div class="item">
              <img src="aptlyserve.png" class="img-responsive" alt="aptly repo">
              <div class="carousel-caption">
                <h3>Serving published repositories</h3>
                <p>Quickly serve published snapshots over HTTP</p>
              </div>
            </div>
            <div class="item">
              <img src="aptlygraph.png" class="img-responsive" alt="aptly repo">
              <div class="carousel-caption">
                <h3>Visualize dependencies</h3>
                <p>Render relationships between mirrors, repos, snapshots and published repositories</p>
              </div>
            </div>
          </div>
          <!-- Controls -->
          <a class="left carousel-control" href="#carousel-ss" data-slide="prev">
            <span class="glyphicon glyphicon-chevron-left"></span>
          </a>
          <a class="right carousel-control" href="#carousel-ss" data-slide="next">
            <span class="glyphicon glyphicon-chevron-right"></span>
          </a>
        </div>

        <p></p>
        <p><a class="btn btn-primary btn-lg" href="#download">Download &rarr;</a></p>
      </div>

      <div id="fb-root"></div>

      <div id="sharing-links">
        <a href="https://twitter.com/share" class="twitter-share-button" data-count="horizontal">Tweet</a>

        <div class="g-plusone" data-size="medium" data-count="true"></div>

        <div class="fb-share-button" data-type="button_count"></div>

        <iframe src="http://ghbtns.com/github-btn.html?user=smira&repo=aptly&type=watch&count=true" height="20" width="118" frameborder="0" scrolling="0" style="width:118px; height: 20px; margin-left: 20px" allowTransparency="true"></iframe>
      </div>

      <h2>Features <small><span class="glyphicon glyphicon-asterisk"></span> means planned features</small></h2>

      <div class="row">
        <div class="col-lg-6">
          <h4>Mirror repository</h4>
          <p>Take and update mirrors of any Debian/Ubuntu remote repository.</p>

          <h4>Take snapshot</h4>
          <p>At any point in time, take snapshot of the mirror to fix current set of packages.</p>

          <h4>Merge snapshots</h4>
          <p>Merge two or more snapshots into one snapshot: e.g. merge wheezy and wheezy-updates.</p>

          <h4>Publish your packages</h4>
          <p>Manage your own repositories of packages, merge them with offical and publish the result.</p>

          <h4>Mirror repositories as-is <span class="glyphicon glyphicon-asterisk"></span></h4>
          <p>Mirror official Debian repositories (as snapshots) without resigning by your own key.</p>
        </div>
        <div class="col-lg-6">
          <h4>Publish snapshot</h4>
          <p>Any snapshot could be published back as repository (only HTTP server is required).</p>

          <h4>Upgrade package versions</h4>
          <p>New package version available in backports? Pull only single package with dependencies from
          backports into snapshot of stable repository.</p>

          <h4>Filter repository <span class="glyphicon glyphicon-asterisk"></span></h4>
          <p>Remove packages that are not required, controlling dependencies between packages.</p>

          <h4>Package search <span class="glyphicon glyphicon-asterisk"></span></h4>
          <p>Search for specific packages, their inclusion into snapshots, etc.</p>

          <h4>Support for yum repositories <span class="glyphicon glyphicon-asterisk"></span></h4>
          <p>Manage packages for CentOS, RHEL, Fedora.</p>
        </div>
      </div>

      <div class="alert alert-warning">
        aptly doesn't yet support
         debian-installer packages (udebs) and translations
      </div>


<!-- ================ examples ============== -->
<div class="target-spacer" id="examples"><a name="examples"></a>&nbsp;</div>
<h2>Examples</h2>

      <p class="lead">Mirror Debian repository distribution squeeze only for architectures <code>i386</code>,
      <code>amd64</code> and publish the result:</p>

      <p><a href="#aptly-mirror-create">Create</a> mirror:</p>

<pre><span class="greeting">$</span> <span class="command">aptly -architectures="amd64,i386"  mirror create debian-main http://ftp.ru.debian.org/debian/ squeeze main</span>
2013/12/28 19:44:45 Downloading http://ftp.ru.debian.org/debian/dists/squeeze/Release...
...

Mirror [debian-main]: http://ftp.ru.debian.org/debian/ squeeze successfully added.
You can run 'aptly mirror update debian-main' to download repository contents.
</pre>

      <p><a href="#aptly-mirror-update">Download</a> mirror contents:</p>
<pre><span class="greeting">$</span> <span class="command">aptly mirror update debian-main</span>
2014/01/15 16:50:50 Downloading http://ftp.ru.debian.org/debian/dists/squeeze/Release...
Downloading &amp; parsing release files...
2014/01/15 16:50:50 Downloading http://ftp.ru.debian.org/debian/dists/squeeze/main/binary-amd64/Packages.bz2...
Saving packages to database...
Building download queue...
Download queue: 27960 items, 30.68 GiB size</pre>

      <p><a href="#aptly-snapshot-create">Take</a> snapshot:</p>

<pre><span class="greeting">$</span> <span class="command">aptly snapshot create debian-3112 from mirror debian-main</span>

Snapshot debian-3112 successfully created.
You can run 'aptly publish snapshot debian-3112' to publish snapshot as Debian repository.
</pre>

    <p><a href="#aptly-publish-snapshot">Publish</a> snapshot (requires generated GPG key):</p>

<pre><span class="greeting">$</span> <span class="command">aptly publish snapshot debian-3112</span>

...

Snapshot debian-3112 has been successfully published.
Please setup your webserver to serve directory '/home/example/.aptly/public' with autoindexing.
Now you can add following line to apt sources:
  deb http://your-server/ squeeze main
Don't forget to add your GPG key to apt with apt-key.
</pre>

      <p>Set up webserver (e.g. nginx):</p>

<pre>server {
      root /home/example/.aptly/public;
      server_name mirror.local;

      location / {
              autoindex on;
      }
}
</pre>

      <p>Add new repository to apt's sources:</p>

<pre>deb http://mirror.local/ squeeze main
</pre>

    <p>Alternatively, you can <a href="#aptly-serve">serve</a> published repositories with aptly itself:</p>

<pre><span class="greeting">$</span> <span class="command">aptly serve</span>
Serving published repositories, recommended apt sources list:

# ./squeeze (main) [amd64, i386] publishes [debian-3112]: Snapshot from mirror [debian-main]: http://ftp.ru.debian.org/debian/ squeeze
deb http://localhost:8080/ squeeze main

Starting web server at: :8080 (press Ctrl+C to quit)...
</pre>

  <p>Run apt-get to fetch repository metadata:</p>

<pre><span class="greeting">$</span> <span class="command">apt-get update</span></pre>

  <p class="lead">Pulling new version of <code>nginx</code> from <code>backports</code>:</p>

  <p><a href="#aptly-mirror-create">Create</a> <code>backports</code> mirror, <a href="#aptly-mirror-update">download</a> it
      and <a href="#aplty-snapshot-create">take</a> snapshot:</p>
<pre><span class="greeting">$</span> <span class="command">aptly -architectures="amd64,i386"  mirror create backports http://mirror.yandex.ru/backports.org/ squeeze-backports</span>
...

<span class="greeting">$</span> <span class="command">aptly mirror update backports</span>
...

<span class="greeting">$</span> <span class="command">aptly snapshot create back from mirror backports</span>
...
</pre>

    <p><a href="#aptly-snapshot-pull">Pull</a> new version of <code>nginx</code> from <code>backports</code> to main Debian snapshot and save result as <code>snap-deb-w-nginx</code>.</p>

<pre><span class="greeting">$</span> <span class="command">aptly snapshot pull debian-3112 back snap-deb-w-nginx nginx</span>
Dependencies would be pulled into snapshot:
    [debian-3112]: Snapshot from mirror [debian-main]: http://ftp.ru.debian.org/debian/ squeeze
from snapshot:
    [back]: Snapshot from mirror [backports]: http://mirror.yandex.ru/backports.org/ squeeze-backports
and result would be saved as new snapshot snap-deb-w-nginx.
Loading packages (49476)...
Building indexes...
<span class="red">[-]</span> nginx-0.7.67-3+squeeze3_i386 removed
<span class="green">[+]</span> nginx-1.2.1-2.2~bpo60+2_all added
<span class="green">[+]</span> nginx-full-1.2.1-2.2~bpo60+2_i386 added
<span class="green">[+]</span> nginx-light-1.2.1-2.2~bpo60+2_i386 added
<span class="green">[+]</span> nginx-common-1.2.1-2.2~bpo60+2_all added
<span class="red">[-]</span> nginx-1.2.1-2.2~bpo60+2_all removed
<span class="red">[-]</span> nginx-0.7.67-3+squeeze3_amd64 removed
<span class="green">[+]</span> nginx-1.2.1-2.2~bpo60+2_all added
<span class="green">[+]</span> nginx-full-1.2.1-2.2~bpo60+2_amd64 added
<span class="green">[+]</span> nginx-light-1.2.1-2.2~bpo60+2_amd64 added

Snapshot snap-deb-w-nginx successfully created.
You can run 'aptly publish snapshot snap-deb-w-nginx' to publish snapshot as Debian repository.
</pre>

    <p>Snapshot <code>snap-deb-w-nginx</code> can be <a href="#aptly-publish-snapshot">published</a> as a separate repository.</p>

<!-- ================ download ============== -->
<div class="target-spacer" id="download"><a name="download"></a>&nbsp;</div>
<h2>Download</h2>

    <p class="lead">Currently released aptly version is <strong>0.6</strong> (<a href="#history">what's new?</a>).
    </p>

    <p>Roadmap:</p>

    <ul>
      <li>0.7 (end of June): searching, S3 publishing</li>
      <li>0.8 (end of July): mirroring as is, yum repositories support</li>
    </ul>

    <p><strong>For Debian/Ubuntu</strong> aptly could be installed from by adding new repository
    to <code>/etc/apt/sources.list</code>:</p>

    <pre>deb http://repo.aptly.info/ squeeze main</pre>

    <p>And importing key that is used to sign the release:</p>

    <pre><span class="greeting">$</span> <span class="command">gpg --keyserver keys.gnupg.net --recv-keys 2A194991</span>
<span class="greeting">$</span> <span class="command">gpg -a --export 2A194991 | sudo apt-key add -</span></pre>

    <p>After that you can install aptly as any other software package:</p>

    <pre><span class="greeting">$</span> <span class="command">apt-get update</span>
<span class="greeting">$</span> <span class="command">apt-get install aptly</span></pre>

    <p>Don't worry about <code>squeeze</code> part in repo name: aptly package should work on Debian squeeze+, Ubuntu 10.0+. Package
    contains aptly binary, man page and bash completion.</p>

    <p><strong>Binary</strong> executables (depends almost only on libc) for Debian, CentOS, MacOS X &amp; FreeBSD are available for
    download from <a href="http://dl.bintray.com/smira/aptly/0.6/">Bintray</a>. Linux executables should run on almost any
    recent Linux distribution.</p>

      <div class="row">
        <div class="col-lg-6">
          <div class="pull-left">
            <img src="debian.png" alt="Debian" class="logo">
          </div>
          <h4>Debian (Ubuntu)</h4>
          <p><strong>see part on installation from .deb package above</strong></p>
          <p>squeeze+: <a href="http://dl.bintray.com/smira/aptly/0.6/debian-squeeze-x32/aptly">32-bit</a> |
                      <a href="http://dl.bintray.com/smira/aptly/0.6/debian-squeeze-x64/aptly">64-bit</a></p>
        </div>
        <div class="col-lg-6">
          <div class="pull-left">
            <img src="centos.png" alt="CentOS" class="logo">
          </div>
          <h4>CentOS (RedHat, Fedora)</h4>
          <p>6.5+: <a href="http://dl.bintray.com/smira/aptly/0.6/centos-6.5-x32/aptly">32-bit</a> |
                  <a href="http://dl.bintray.com/smira/aptly/0.6/centos-6.5-x64/aptly">64-bit</a></p>
        </div>
      </div>
      <div class="row">
        <div class="col-lg-6">
          <div class="pull-left">
            <img src="freebsd.png" alt="FreeBSD" class="logo">
          </div>
          <h4>FreeBSD</h4>
          <p>9.2+: <a href="http://dl.bintray.com/smira/aptly/0.6/freebsd-9.2-x32/aptly">32-bit</a> |
                  <a href="http://dl.bintray.com/smira/aptly/0.6/freebsd-9.2-x64/aptly">64-bit</a></p>
        </div>
        <div class="col-lg-6">
          <div class="pull-left">
            <img src="macosx.png" alt="Mac OS X" class="logo">
          </div>
          <h4>Mac OS X</h4>
          <p>10.9: <a href="http://dl.bintray.com/smira/aptly/0.6/osx/aptly">64-bit</a></p>
        </div>
      </div>
      <div class="row">
        <div class="col-lg-4">
        </div>
        <div class="col-lg-4">
          <p>
            <a href='http://www.bintray.com/smira/aptly/aptly'>
              <img src='http://www.bintray.com/docs/images/poweredByBintray_ColorTransparent.png' width="100" height="55" alt="BinTray logo">
            </a>
          </p>
        </div>
        <div class="col-lg-4">
        </div>
      </div>

    <p>Just copy binary to your machine, make it executable and run it:</p>

<pre><span class="greeting">$</span> <span class="command">chmod +x aptly</span>
<span class="greeting">$</span> <span class="command">./aptly</span></pre>

    <p><strong>Bash completion</strong> for aptly is available as <a href="https://github.com/aptly-dev/aptly-bash-completion">separate repo</a>.</p>

    <p>If you have Go environment set up (go 1.1+ required), you can build aptly from <strong>source</strong> by
    cloning it and building with gom:</p>

<pre><span class="greeting">$</span> <span class="command">go get -u github.com/mattn/gom</span>
<span class="greeting">$</span> <span class="command">mkdir -p $GOPATH/src/github.com/smira/aptly</span>
<span class="greeting">$</span> <span class="command">git clone https://github.com/smira/aptly $GOPATH/src/github.com/smira/aptly</span>
<span class="greeting">$</span> <span class="command">cd $GOPATH/src/github.com/smira/aptly</span>
<span class="greeting">$</span> <span class="command">gom -production install</span>
<span class="greeting">$</span> <span class="command">gom build -o $GOPATH/bin/aptly</span>
<span class="greeting">$</span> <span class="command">aptly</span>
</pre>

<!-- ================ support ============== -->
<div class="target-spacer" id="support"><a name="support"></a>&nbsp;</div>
<h2>Support</h2>

  <p>If you have trouble using aptly, you can find community support from
  <a href="https://groups.google.com/forum/#!forum/aptly-discuss">aptly-discuss mailing list</a> or file
  an <a href="https://github.com/smira/aptly/issues">issue on GitHub</a>.</p>

  <p>Please following me (<a href="https://twitter.com/smira/">@smira</a>) to get updates about aptly.



<!-- ================ usage ============== -->
<div class="target-spacer" id="usage"><a name="usage"></a>&nbsp;</div>
<h2>Usage</h2>


  <p>
  aptly goal is to establish repeatiblity and controlled changes in package environment. aptly allows
  to fix set of packages in repository, so that package installation and upgrade becomes deterministic.
  At the same time aptly allows to perform controlled, fine-grained changes in repository contents to
  transition your package environment to new version.</p>

  <div class="target-spacer" id="usage"><a name="core-concepts"></a>&nbsp;</div>
  <h3>Core Concepts</h3>

  <dl class="dl-horizontal">
    <dt>mirror</dt>
    <dd>mirror of remote repository, consists of metadata, list of packages and package files</dd>

    <dt>local repo</dt>
    <dd>local package repository, consists of metadata, packages and files, packages could be easily added and removed</dd>

    <dt>snapshot</dt>
    <dd>immutable list of packages, basic block to implement repeatability and controlled changes</dd>

    <dt>published repository</dt>
    <dd>published representation of snapshot or local repository, ready to be consumed by apt tools</dd>
  </dl>

  <p>The schema of aptly's commands and transitions between entities:</p>

  <p><img src="schema.png" class="img-responsive" alt="aptly snapshot diff"></p>

  <p>We can start with creating <a href="#aptly-mirror-create">mirrors of remote repositories</a>. Also
  you can create <a href="#aptly-repo-create">local package repositories</a> and import there packages
  as files. Local repos could be modified by <a href="#aptly-repo-copy">copying</a> and <a href="#aptly-repo-move">moving</a>
  packages between local repositories and <a href="#aptly-repo-import">importing</a> them from mirrors.
  Snapshot could be <a href="#aptly-snapshot-create">created</a> from remote repository
  (official Debain repositories, backports, 3rd party repos, etc.) or your local repository (custom built
  packages, your own software). Snapshots
  can be used to produce new snapshots by <a href="#aptly-snapshot-pull">pulling</a> packages with dependencies between snapshots
  and by <a href="#aptly-snapshot-merge">merging</a> snapshots. Any snapshot can be
  <a href="#aptly-publish-snapshot">published</a> to location
  (distribution name, prefix) and consumed by <code>apt</code> tools on your Debian systems. Local repositories
  could be <a href="#aptly-publish-repo">published directly</a> bypassing snapshot step.</p>

  <div class="target-spacer" id="commands"><a name="commands"></a>&nbsp;</div>
  <h3>Commands</h3>
      <p>Aptly supports commands in three basic categories:</p>

      <ul>
      <li>  <code>mirror</code>: manage, update mirrors of remote repositories
      </li>
      <li>  <code>repo</code>: manage local package repositories, add, remove, move, copy packages
      </li>
      <li>  <code>snapshot</code>: create, merge, manage snapshots
      </li>
      <li>  <code>publish</code>: publish snapshot or local repository
      </li>
      <li>  <code>serve</code>: quickly export published repositories via HTTP
      </li>
      </ul>

  <!-- ================ configuration ============== -->
  <div class="target-spacer" id="configuration"><a name="configuration"></a>&nbsp;</div>
  <h3>Configuration</h3>

    <p>aptly looks for configuration file in <code>/etc/aptly.conf</code> and
    <code>~/.aptly.conf</code>, if no config file found, new one is created. If <code>-config=</code> flag is
    specified, aptly would use config file at specified location. Also aptly
    needs root directory for database, package and published repository
    storage. If not specified, directory defaults to <code>~/.aptly</code>, it will be
    created if missing.</p>

    <p>Configuration file is stored in JSON format (default values shown below):</p>

<pre>{
  "rootDir": "$HOME/.aptly",
  "downloadConcurrency": 4,
  "downloadSpeedLimit": 0,
  "architectures": [],
  "dependencyFollowSuggests": false,
  "dependencyFollowRecommends": false,
  "dependencyFollowAllVariants": false,
  "dependencyFollowSource": false,
  "gpgDisableSign": false,
  "gpgDisableVerify": false,
  "downloadSourcePackages": false,
  "ppaDistributorID": "ubuntu",
  "ppaCodename": ""
}
</pre>

    <p>Options:</p>

    <ul>
      <li>  <code>rootDir</code> is root of directory storage to store database
      (<code>rootDir/db</code>), downloaded packages (<code>rootDir/pool</code>) and published
      repositories (<code>rootDir/public</code>)</li>
      <li>  <code>downloadConcurrency</code> is a number of parallel download threads to
      use when downloading packages</li>
      <li>  <code>downloadSpeedLimit</code> is a limit on download bandwidth used by aptly in
      kbytes per second, 0 means unlimited</li>
      <li>  <code>architectures</code> is a list of architectures to process; if left empty
      defaults to all available architectures; could be overridden with
      option <code>-architectures</code>
      </li>
      <li>  <code>dependencyFollowSuggests</code>: follow contents of <code>Suggests:</code> field
      when processing dependencies for the package</li>
      <li>  <code>dependencyFollowRecommends</code>: follow contents of <code>Recommends:</code> field
      when processing dependencies for the package</li>
      <li>  <code>dependencyFollowAllVariants</code>: when dependency looks like
      <code>package-a | package-b</code>, follow both variants always</li>
      <li>  <code>dependencyFollowSource</code>: follow dependency from binary package to source package</li>
      <li>  <code>gpgDisableSign</code>: don't sign published repositories with <code>gpg</code>, also can be
      disabled on per-repo basis using <code>-skip-signing</code> flag when publishing</li>
      <li>  <code>gpgDisableVerify</code>: don't verify remote mirrors with <code>gpg</code>, also can be
      disabled on per-mirror basis using <code>-ignore-signatures</code> flag when creating and updating mirrors</li>
      <li>
        <code>downloadSourcePackages</code>:
        if enabled, all mirrors created would have flag set to download source packages; this setting could be controlled
        on per-mirror basis with <code>-with-sources</code> flag
      </li>
      <li><code>ppaDistributorID</code> &amp; <code>ppaCodename</code> specifies paramaters for short PPA url expansion,
          if left blank they default to output of <code>lsb_release</code> command
    </ul>

    <div class="alert alert-warning"><strong>Warning:</strong> <code>rootDir</code> contains all the downloaded packages from remote mirrors,
      so it should have enough space. For example. mirror of Debian wheezy (amd64 and i386) requires 70 GiB of disk space.
    </div>

    <p>aptly would use HTTP proxy configured in <code>HTTP_PROXY</code> environment variable automatically.</p>

  <!-- ================ common options ============== -->
  <div class="target-spacer" id="common-options"><a name="common-options"></a>&nbsp;</div>
  <h3>Global Flags</h3>

      <p>There are several flags that should be specfied right before command
      name:</p>

        <pre><span class="greeting">$</span> <span class="command">aptly --option1 command ...</span></pre>

      <p>These flags are:</p>

        <ul>
        <li>
          <code>-architectures=""</code>: list of architectures to consider during
          (comma-separated), default to all available
        </li>
        <li>
          <code>-config=""</code>: location of configuration file (default locations are
          <code>/etc/aptly.conf</code>, <code>~/.aptly.conf</code>)
        </li>
        <li>
          <code>-dep-follow-all-variants=false</code>: when processing dependencies,
          follow a &amp; b if depdency is 'a|b'
        </li>
        <li>
          <code>-dep-follow-recommends=false</code>: when processing dependencies, follow
            Recommends
        </li>
        <li>
          <code>-dep-follow-source=false</code>: when processing dependencies, follow
            from binary package to source package
        </li>
        <li>
          <code>-dep-follow-suggests=false</code>: when processing dependencies, follow
          Suggests</li>
        </ul>

      <p>Global flags override configuration parameters with similar names.</p>

  <!-- ================ package-spec ============== -->
  <div class="target-spacer" id="package-spec"><a name="package-spec"></a>&nbsp;</div>
  <h3>Package Spec</h3>

  <p>Some commands accept package specs to identify list of packages to process. Package spec is a list of
  following search conditions:</p>

  <ul>
    <li><strong>direct package reference</strong>: reference to exaclty one package. Format is identical to the way
    aptly lists packages in <code>show</code> commands with <code>-with-packages</code> flag: <code>name_version_arch</code>, e.g.:
    <code>libmysqlclient18_5.5.35-rel33.0-611.squeeze_amd64</code> </li>
    <li><strong>dependency condition</strong>: syntax follows Debian dependency specification: <code>package_name</code> followed by
    optional version specification and architecture limit.<br/> Examples:
    <ul>
      <li>
        <code>mysql-client</code>: matches package <code>mysql-client</code> of any version and
        architecture (including <code>source</code>)
      </li>
      <li>
        <code>mysql-client (&gt;= 3.6)</code>: matches package <code>mysql-client</code> with version greater or equal to <code>3.6</code>.
        Valid operators for version are: <code>&gt;=</code>, <code>&lt;=</code>, <code>=</code>, <code>&gt;&gt;</code> (strictly greater),
        <code>&lt;&lt;</code> (strictly less).
      </li>
      <li>
        <code>mysql-client {i386}</code>: matches package <code>mysql-client</code> on architecture <code>i386</code>, architecture
        <code>all</code> matches all architectures but source.
      </li>
      <li>
        <code>mysql-client (&gt;= 3.6) {i386}</code>: version and architecture conditions combined.
      </li>
    </ul>
    When specified on command line, condition may have to be quoted according to shell rules, so that it stays single argument:
    <code>aptly repo import percona stable 'mysql-client (&gt;= 3.6)'</code>.
    </li>
  </ul>


  <!-- ================ duplicate-packages ============== -->
  <div class="target-spacer" id="duplicate-packages"><a name="duplicate-packages"></a>&nbsp;</div>
  <h3>On duplicate packages</h3>

  <p>In ideal world, tuple <code>(architecture, name, version)</code> should identify unique package.
  That holds true (well, almost true) with Debian-based distributions. If two packages with the same
  architecture, name and version are coming from different sources, they should be identical.</p>

  <p>Debian <a href="https://wiki.debian.org/RepositoryFormat">documentation on repository format</a> explicitly
  forbids duplicate packages with different content in one repository or in set of repositories for one
  distribution:</p>

  <blockquote>A repository must not include different packages (different content) with the same package name, version, and architecture. When a repository is meant to be used as a supplement to another repository this should hold for the joint main+supplement repository as well.</blockquote>

  <p>aptly deduplicates packages with identical <code>(architecture, name, version)</code> tuple and contents into
  one single package record and treats them as single package. But if two packages share architecture, name and version,
  but have different content, aptly would treat them as different packages. Such packages should never be placed
  into one list in aptly (into one local repo, snapshot, mirror, etc.) When such thing happens, aptly would
  complain about conflict in packages. Usually such duplicate packages with different content represent some
  software packaged for different Debian distribution, so they should never be in the same list.</p>

  <!-- ================ integrations ============== -->
  <div class="target-spacer" id="integrations"><a name="integrations"></a>&nbsp;</div>
  <h3>Integrations</h3>

  <p>With configuration management systems:</p>

  <ul>
    <li><a href="https://github.com/hw-cookbooks/aptly">Chef cookbook</a> by Aaron Baer (Heavy Water Operations, LLC)</li>
    <li><a href="https://github.com/alphagov/puppet-aptly">Puppet module</a> by Government Digital Services</li>
  </ul>

<!-- ================ aptly mirror ============== -->
<div class="target-spacer" id="aptly-mirror"><a name="aptly-mirror"></a>&nbsp;</div>
<h3>Command <code>mirror</code></h3>

      <p>Mirror subcommands manage mirrors of remote Debian repositories.</p>

  <!-- ================ aptly mirror create ============== -->
  <div class="target-spacer" id="aptly-mirror-create"><a name="aptly-mirror-create"></a>&nbsp;</div>
  <h4>Command <code>aptly mirror create</code></h4>

    <p>Creates mirror of remote repository, aptly supports both regular and flat Debian repositories exported via HTTP. aptly would try download
    Release file from remote repository and verify its signature.</p>

    <p>Usage:</p>

    <pre><span class="greeting">$</span> <span class="command"> aptly mirror create &lt;name&gt; &lt;archive url&gt; &lt;distribution&gt; [&lt;component1&gt; ...]</span></pre>

    <p>For Launchpad PPAs:</p>

    <pre><span class="greeting">$</span> <span class="command"> aptly mirror create &lt;name&gt; &lt;ppa:user/project&gt;</span></pre>

    <p>Params are:</p>

    <ul>
    <li>  <code>name</code> is a name that would be used in aptly to reference this
    mirror</li>
    <li>  <code>archive url</code> is a root of archive, e.g.
    <a href="http://ftp.ru.debian.org/debian/">http://ftp.ru.debian.org/debian/</a>
    </li>
    <li>  <code>distribution</code> is a distribution name, e.g. <code>squeeze</code>, for flat repositories use <code>./</code> instead of distribution name
    </li>
    <li>  <code>component1</code> is an optional list of components to download, if not
    specified aptly would fetch all components, e.g. <code>main</code>
    </li>
    </ul>

    <p>Flags:</p>

    <ul>
      <li>
        <code>-ignore-signatures=false</code>: disable verification of Release file signatures
      </li>
      <li>
        <code>-keyring=trustedkeys.gpg</code>: gpg keyring to use when verifying Release file (could be specified multiple times)
      </li>
      <li>
        <code>-with-sources=false</code>: download source packages in addition to binary packages (could be enabled by default with config
        option <code>downloadSourcePackages</code>)
      </li>
    </ul>

    <p>By default aptly would download packages for all available architectures.
    If architectures are limited (with config <code>architectures</code> or option
    <code>-architectures</code>), only packages for those architectures are downloaded</p>

    <div class="alert alert-info">If components are not specified, aptly will download packages from all
    components and merge it into one when publishing. If components should be left separate, please
    create separate mirror for each component.</div>

    <p>If PPA url is specified, aptly would expand it to HTTP url using configuration options <code>ppaDistributorID</code> &amp;
    <code>ppaCodename</code>. If you're running aptly on Ubuntu, defaults should work (aptly would figure out codename using
    <code>lsb_release</code> command).</p>

    <p>aptly would try to verify signature of Release files using GnuPG. By default, keyring <code>~/.gnupg/trustedkeys.gpg</code>
    would be used. If you would like to use different keyring(s), specify them using <code>-keyring</code> flag. aptly would
    advise <code>gpg</code> commands to import keys into trusted keys keyring in order to successfully verify repository signature.
    </p>

    <p>If aptly is running on Debian/Ubuntu machine, it would be good to import archive signing keys shipped with the operating system:</p>

<pre><span class="greeting">$</span> <span class="command">gpg --keyring /usr/share/keyrings/debian-archive-keyring.gpg --export | gpg --no-default-keyring --keyring trustedkeys.gpg --import</span></pre>

    <p class="small">If you're running Ubuntu, use <code>/usr/share/keyrings/ubuntu-archive-keyring.gpg</code></p>

    <p>If GnuPG is complaining that required key to verify signature is missing, it would report key ID, e.g. <code>46925553</code>. Keys
    could be downloaded from public keyserver and imported into trusted keyring using command:</p>

    <pre><span class="greeting">$</span> <span class="command">gpg --no-default-keyring --keyring trustedkeys.gpg --keyserver keys.gnupg.net --recv-keys 46925553</span></pre>

    <p class="small">Replace <code>46925553</code> with the key ID GnuPG is complaining about.</p>

    <p>If you're mirroring flat repository, sometimes repository key is located near release files, so you can download it and import into
    your trusted keychain:</p>

    <pre><span class="greeting">$</span> <span class="command">wget -O - http://some.repo/repository/Release.key | gpg --no-default-keyring --keyring trustedkeys.gpg --import</span></pre>

    <p>You can learn about signed Debian repositories in <a href="https://wiki.debian.org/SecureApt">Debian wiki</a>. If you would like to disable
    signature checks, you can use flag <code>-ignore-signatures</code> or configuration setting <code>gpgDisableVerify</code>.</p>

    <div class="alert alert-info">aplty deduplicates all downloaded files, so if two mirrors are created one with source packages enabled
    and another with source packages disabled, they would consume only space required to store all binary and source packages (not twice
    the space required to store binary packages).</div>

    <p>Example:</p>

<pre><span class="greeting">$</span> <span class="command">aptly -architectures="amd64" mirror create debian-main http://ftp.ru.debian.org/debian/ squeeze main</span>
2013/12/28 19:44:45 Downloading http://ftp.ru.debian.org/debian/dists/squeeze/Release...
...

Mirror [debian-main]: http://ftp.ru.debian.org/debian/ squeeze successfully added.
You can run 'aptly mirror update debian-main' to download repository contents.
</pre>

  <!-- ================ aptly mirror update ============== -->
  <div class="target-spacer" id="aptly-mirror-update"><a name="aptly-mirror-update"></a>&nbsp;</div>
  <h4>Command <code>aptly mirror update</code></h4>

    <p>Updates remote mirror (downloads package files and meta information). When mirror is
    created, this command should be run for the first time to fetch mirror contents.
    This command could be run many times to get updated repository contents.
    If interrupted, command could be restarted safely.</p>

    <p>Usage:</p>

    <pre><span class="greeting">$</span> <span class="command">aptly mirror update &lt;name&gt;</span></pre>

    <p>Params are:</p>

    <ul>
    <li>  <code>name</code> is a mirror name (given when mirror was created)</li>
    </ul><p>All packages would be stored under aptly's root dir (see section on
    <a href="#configuration">Configuration</a>).</p>

    <p>Flags:</p>

    <ul>
      <li>
        <code>-download-limit=0</code>: limit download speed (kbytes/sec)
      </li>
      <li>
        <code>-ignore-checksums=false</code>: ignore checksum mismatches for downloaded items (packages file, metadata)
      </li>
      <li>
        <code>-ignore-signatures=false</code>: disable verification of Release file signatures
      </li>
      <li>
        <code>-keyring=trustedkeys.gpg</code> gpg keyring to use when verifying Release file (could be specified multiple times)
      </li>
    </ul>

    <p>While updating mirror, aptly would verify signature of Release file using GnuPG. Please read information about signature verification
    in <a href="#aptly-mirror-create">aptly mirror create</a> command description.</p>


    <p>Example:</p>

<pre><span class="greeting">$</span> <span class="command">aptly mirror update debian-main</span>

2013/12/29 18:32:34 Downloading http://ftp.ru.debian.org/debian/dists/squeeze/Release...
2013/12/29 18:32:37 Downloading http://ftp.ru.debian.org/debian/dists/squeeze/main/binary-amd64/Packages.bz2...
2013/12/29 18:37:19 Downloading http://ftp.ru.debian.org/debian/pool/main/libg/libgwenhywfar/libgwenhywfar47-dev_3.11.3-1_amd64.deb...
....
</pre>

  <!-- ================ aptly mirror list ============== -->
  <div class="target-spacer" id="aptly-mirror-list"><a name="aptly-mirror-list"></a>&nbsp;</div>
  <h4>Command <code>aptly mirror list</code></h4>

    <p>Shows list of registered repository mirrors.</p>

    <p>Usage:</p>

    <pre><span class="greeting">$</span> <span class="command">aptly mirror list</span></pre>

    <p>Flags:</p>

    <ul>
      <li>
        <code>-raw=false</code>: display list in machine-readable format
      </li>
    </ul>

    <p>Examples:</p>

<pre><span class="greeting">$</span> <span class="command">aptly mirror list</span>
List of mirrors:
 * [backports]: http://mirror.yandex.ru/backports.org/ squeeze-backports
 * [debian-main]: http://ftp.ru.debian.org/debian/ squeeze

To get more information about repository, run `aptly mirror show &lt;name&gt;`.
</pre>

<pre><span class="greeting">$</span> <span class="command">aptly mirror list -raw</span>
backports
debian-main
</pre>

  <!-- ================ aptly mirror show ============== -->
  <div class="target-spacer"  id="aptly-mirror-show"><a name="aptly-mirror-show"></a>&nbsp;</div>
  <h4>Command <code>aptly mirror show</code></h4>

    <p>Shows detailed information about mirror.</p>

    <p>Usage:</p>

    <pre><span class="greeting">$</span> <span class="command">aptly mirror show &lt;name&gt;</span></pre>

    <p>Params are:</p>

    <ul>
    <li>  <code>name</code> is a mirror name (given when mirror was created)</li>
    </ul>

    <p>Flags:</p>

    <ul>
    <li>  <code>-with-packages=false</code>: show detailed list of packages and versions stored in the mirror</li>
    </ul>

    <p>Example:</p>

<pre><span class="greeting">$</span> <span class="command">aptly mirror show backports2</span>
Name: backports2
Archive Root URL: http://mirror.yandex.ru/backports.org/
Distribution: squeeze-backports
Components: main, contrib, non-free
Architectures: i386, amd64
Last update: 2013-12-27 19:30:19 MSK
Number of packages: 3898

Information from release file:
...
</pre>

    <p>In detailed information basic information about mirror is displayed:
    filters by component &amp; architecture, timestamp of last successful
    repository fetch and number of packages.</p>

  <!-- ================ aptly mirror drop ============== -->
  <div class="target-spacer" id="aptly-mirror-drop"><a name="aptly-mirror-drop"></a>&nbsp;</div>
  <h4>Command <code>aptly mirror drop</code></h4>

    <p>Drop deletes information about remote repository mirror. Package data is not deleted
      (it could be still used by other mirrors or snapshots). If mirror is used as source to create a snapshot,
      aptly would refuse to delete such mirror, use flag <code>-force</code> to override.
    </p>

    <p>Usage:</p>

    <pre><span class="greeting">$</span> <span class="command">aptly mirror drop &lt;name&gt;</span></pre>

    <p>Params:</p>

    <ul>
    <li>  <code>name</code> is mirror name which has been given during mirror
    creation</li>
    </ul>

    <p>Flags:</p>

    <ul>
    <li>  <code>-force=false</code>: drop mirror even if it used as source of some snapshot</li>
    </ul>

    <div class="alert alert-info">Dropping mirror only removes metadata about the mirror, in order to cleanup the disk
    space occupied by package files you might need to run <a href="#aptly-db-cleanup"><code>aptly db cleanup</code></a> command.</div>

    <p>Example:</p>

<pre><span class="greeting">$</span> <span class="command">aptly mirror drop -force wheezy-main</span>
Mirror `wheezy-main` has been removed.</pre>

<!-- ================ aptly repo ============== -->
<div class="target-spacer" id="aptly-repo"><a name="aptly-repo"></a>&nbsp;</div>
<h3>Command <code>repo</code></h3>

      <p>Repo subcommands manage local package repositories.</p>

  <!-- ================ aptly repo create ============== -->
  <div class="target-spacer" id="aptly-repo-create"><a name="aptly-repo-create"></a>&nbsp;</div>
  <h4>Command <code>aptly repo create</code></h4>

    <p>Create local package repository. Repository would be empty when created, packages could be added from files,
    copied or moved from another local repository or imported from the mirror.</p>

    <p>Usage:</p>

    <pre><span class="greeting">$</span> <span class="command"> aptly repo create &lt;name&gt;</span></pre>

    <p>Params are:</p>

    <ul>
    <li>  <code>name</code> is a name that would be used in aptly to reference this
    repository</li>
    </ul>

    <p>Flags:</p>

    <ul>
      <li>
        <code>-comment=""</code>: any text that would be used to described local repository
      </li>
      <li>
        <code>-component="main"</code>: default component when publishing
      </li>
      <li>
        <code>-distribution=""</code>: default distribution when publishing
      </li>
    </ul>

    <p>Default distribution and component would be taken as defaults when publishing repository
    either directly or via snapshots.</p>


    <p>Example:</p>

<pre><span class="greeting">$</span> <span class="command">aptly repo create -comment="Nightly builds" testing</span>

Local repo [stable] successfully added.
You can run 'aptly repo add stable ...' to add packages to repository.
</pre>

  <!-- ================ aptly repo add ============== -->
  <div class="target-spacer" id="aptly-repo-add"><a name="aptly-repo-add"></a>&nbsp;</div>
  <h4>Command <code>aptly repo add</code></h4>

    <p>Command adds packages to local repository from <code>.deb</code> (binary packages) and
    <code>.dsc</code> (source packages) files. When importing from directory aptly would do
    recursive scan looking for all files matching <code>*.deb</code> or <code>*.dsc</code>
    patterns. Every file discovered would be analyzed to extract metadata, package would be
    created and added to database. Files would be imported to internal package pool. For source packages,
    all required files are added as well automatically. Extra files for source package should be
    in the same directory as <code>*.dsc</code> file.</p>

    <p>Usage:</p>

    <pre><span class="greeting">$</span> <span class="command"> aptly repo add &lt;name&gt; &lt;package file&gt;|&lt;directory&gt; ...</span></pre>

    <p>Params are:</p>

    <ul>
    <li>  <code>name</code> is local repository name </li>
    </ul>

    <p>Flags:</p>

    <ul>
      <li>
        <code>-remove-files=false</code>: remove files that have been imported successfully into repository
      </li>
    </ul>

    <p>Local repositories work best for distribution of in-house software or for custom-built upstream packages.
    Command <code>aptly repo add</code> allows to add source packages and built binary package to local repository.
    Local repository could be snapshotted, possibly mixed with snapshots of official repositories and published
    for cunsumption.</p>

    <p>aptly won't complain if package is added to the repo which is complete duplicate. However it is forbidden to
    have two packages with identical triples (architecture, name, version) that have different metadata or files.
    All files added to package pool would be deduplicated, as it happens with files coming from mirrors, so exactly one
    copy of each file would be stored in aptly pool.
    </p>

    <p>Flag <code>-remove-files</code> allows to implement concept <code>incoming/</code> directory where packages
    are removed as soon as they're imported into database.</p>

    <p>Example:</p>

<pre><span class="greeting">$</span> <span class="command">aptly repo add testing files/libboost-program-options-dev_1.49.0.1_i386.deb</span>
Loading packages...
<span class="green">[+]</span> libboost-program-options-dev_1.49.0.1_i386 added
</pre>

  <!-- ================ aptly repo import ============== -->
  <div class="target-spacer" id="aptly-repo-import"><a name="aptly-repo-import"></a>&nbsp;</div>
  <h4>Command <code>aptly repo import</code></h4>

    <p>Commands import copies packages matching <a href="#package-spec">package spec</a> from mirror <code>src-name</code>
    to local repo <code>dst-repo</code>. If dependency following is enabled, aptly would try to copy
    missing dependencies from <code>src-mirror</code> as well.</p>

    <p>Usage:</p>

    <pre><span class="greeting">$</span> <span class="command"> aptly repo import &lt;src-mirror&gt; &lt;dst-repo&gt; &lt;package-spec&gt; ...</span></pre>

    <p>Params are:</p>

    <ul>
    <li>  <code>src-mirror</code> packages would be searched in this mirror</li>
    <li>  <code>dst-repo</code> packages would be copied to this local repository</li>
    <li>  <code>package-spec</code> list of <a href="#package-spec">package search conditions</a></li>
    </ul>

    <p>Flags:</p>

    <ul>
      <li>
        <code>-dry-run=false</code>: don't import, just show what would be imported
      </li>
      <li>
        <code>-with-deps=false</code>: follow dependencies when processing package-spec
      </li>
    </ul>

    <p>When copying with dependencies, global dependency options are used. For example, to copy source packages, use
    <code>-dep-follow-source</code>. If aptly won't be able to guess list of architectures from contents of local repository
    <code>dst-repo</code>, architectures should be specified with <code>-architectures</code> flag.</p>

    <p>Example:</p>

<pre><span class="greeting">$</span> <span class="command">aptly repo import percona testing percona-server-client-5.5</span>
Loading packages...
<span class="green">[o]</span> percona-server-client-5.5_5.5.35-rel33.0-611.squeeze_i386 imported
<span class="green">[o]</span> percona-server-client-5.5_5.5.35-rel33.0-611.squeeze_amd64 imported
</pre>


<!-- ================ aptly repo show ============== -->
  <div class="target-spacer" id="aptly-repo-show"><a name="aptly-repo-show"></a>&nbsp;</div>
  <h4>Command <code>aptly repo show</code></h4>

    <p>Commands show displays information about local repository, possibly listing all packages in the repository.</p>

    <p>Usage:</p>

    <pre><span class="greeting">$</span> <span class="command"> aptly repo show &lt;name&gt;</span></pre>

    <p>Params are:</p>

    <ul>
    <li>  <code>name</code> local repository name</li>
    </ul>

    <p>Flags:</p>

    <ul>
    <li>  <code>-with-packages=false</code>: show detailed list of packages and versions stored in the mirror</li>
    </ul>

    <p>Example:</p>

<pre><span class="greeting">$</span> <span class="command">aptly repo show -with-packages stable</span>
Name: stable
Comment: Stable packages for project Foo
Default Distribution: wheezy
Default Component: main
Number of packages: 10
Packages:
  libmysqlclient18_5.5.35-rel33.0-611.squeeze_amd64
  percona-server-client-5.5_5.5.35-rel33.0-611.squeeze_amd64
  percona-server-common-5.5_5.5.35-rel33.0-611.squeeze_amd64
  percona-server-server_5.5.35-rel33.0-611.squeeze_amd64
  percona-server-server-5.5_5.5.35-rel33.0-611.squeeze_amd64
  libmysqlclient18_5.5.35-rel33.0-611.squeeze_i386
  percona-server-client-5.5_5.5.35-rel33.0-611.squeeze_i386
  percona-server-common-5.5_5.5.35-rel33.0-611.squeeze_i386
  percona-server-server_5.5.35-rel33.0-611.squeeze_i386
  percona-server-server-5.5_5.5.35-rel33.0-611.squeeze_i386
</pre>

<!-- ================ aptly repo list ============== -->
  <div class="target-spacer" id="aptly-repo-list"><a name="aptly-repo-list"></a>&nbsp;</div>
  <h4>Command <code>aptly repo list</code></h4>

    <p>Commands list shows list of all local package repositories.</p>

    <p>Usage:</p>

    <pre><span class="greeting">$</span> <span class="command"> aptly repo list</span></pre>

    <p>Flags:</p>

    <ul>
      <li>
        <code>-raw=false</code>: display list in machine-readable format
      </li>
    </ul>

    <p>Examples:</p>

<pre><span class="greeting">$</span> <span class="command">aptly repo list</span>
List of local repos:
 * [stable]: Stable packages for project Foo (packages: 10)
 * [testing] (packages: 1)

To get more information about local repository, run `aptly repo show &lt;name&gt;`.
</pre>

<pre><span class="greeting">$</span> <span class="command">aptly repo list -raw</span>
stable
testing
</pre>

  <!-- ================ aptly repo copy ============== -->
  <div class="target-spacer" id="aptly-repo-copy"><a name="aptly-repo-copy"></a>&nbsp;</div>
  <h4>Command <code>aptly repo copy</code></h4>

    <p>Commands copy copies packages matching <a href="#package-spec">package spec</a> from local repo <code>src-name</code>
    to local repo <code>dst-name</code>. If dependency following is enabled, aptly would try to copy
    missing dependencies from <code>src-name</code> as well.</p>

    <p>Usage:</p>

    <pre><span class="greeting">$</span> <span class="command"> aptly repo copy &lt;src-name&gt; &lt;dst-name&gt; &lt;package-spec&gt; ...</span></pre>

    <p>Params are:</p>

    <ul>
    <li>  <code>src-name</code> packages would be searched in this local repository</li>
    <li>  <code>dst-name</code> packages would be copied to this local repository</li>
    <li>  <code>package-spec</code> list of <a href="#package-spec">package search conditions</a></li>
    </ul>

    <p>Flags:</p>

    <ul>
      <li>
        <code>-dry-run=false</code>: don't copy, just show what would be copied
      </li>
      <li>
        <code>-with-deps=false</code>: follow dependencies when processing package-spec
      </li>
    </ul>

    <p>When copying with dependencies, global dependency options are used. For example, to copy source packages, use
    <code>-dep-follow-source</code>. If aptly won't be able to guess list of architectures from contents of local repository
    <code>dst-name</code>, architectures should be specified with <code>-architectures</code> flag.</p>

    <p>Example:</p>

<pre><span class="greeting">$</span> <span class="command">aptly repo copy stable testing percona-server-client-5.5</span>
Loading packages...
<span class="green">[o]</span> percona-server-client-5.5_5.5.35-rel33.0-611.squeeze_i386 copied
<span class="green">[o]</span> percona-server-client-5.5_5.5.35-rel33.0-611.squeeze_amd64 copied
</pre>

  <!-- ================ aptly repo move ============== -->
  <div class="target-spacer" id="aptly-repo-move"><a name="aptly-repo-move"></a>&nbsp;</div>
  <h4>Command <code>aptly repo move</code></h4>

    <p>Commands move moves packages matching <a href="#package-spec">package spec</a> from local repo <code>src-repo</code>
    to local repo <code>dst-name</code>. If dependency following is enabled, aptly would try to move
    dependencies from <code>src-name</code> as well.</p>

    <p>Usage:</p>

    <pre><span class="greeting">$</span> <span class="command"> aptly repo move &lt;src-name&gt; &lt;dst-name&gt; &lt;package-spec&gt; ...</span></pre>

    <p>Params are:</p>

    <ul>
    <li>  <code>src-name</code> packages would be searched in this local repository</li>
    <li>  <code>dst-name</code> packages would be moved to this local repository</li>
    <li>  <code>package-spec</code> list of <a href="#package-spec">package search conditions</a></li>
    </ul>

    <p>Flags:</p>

    <ul>
      <li>
        <code>-dry-run=false</code>: don't move, just show what would be moved
      </li>
      <li>
        <code>-with-deps=false</code>: follow dependencies when processing package-spec
      </li>
    </ul>

    <p>When moving with dependencies, global dependency options are used. For example, to move source packages, use
    <code>-dep-follow-source</code>. If aptly won't be able to guess list of architectures from contents of local repository
    <code>dst-name</code>, architectures should be specified with <code>-architectures</code> flag.</p>

    <p>Example:</p>

<pre><span class="greeting">$</span> <span class="command">aptly repo move stable testing percona-server-client-5.5</span>
Loading packages...
<span class="green">[o]</span> percona-server-client-5.5_5.5.35-rel33.0-611.squeeze_i386 moved
<span class="green">[o]</span> percona-server-client-5.5_5.5.35-rel33.0-611.squeeze_amd64 moved
</pre>

  <!-- ================ aptly repo remove ============== -->
  <div class="target-spacer" id="aptly-repo-remove"><a name="aptly-repo-remove"></a>&nbsp;</div>
  <h4>Command <code>aptly repo remove</code></h4>

    <p>Commands remove deletes packages matching <a href="#package-spec">package spec</a> from local repo <code>name</code>.</p>

    <p>Usage:</p>

    <pre><span class="greeting">$</span> <span class="command"> aptly repo remove &lt;name&gt; &lt;package-spec&gt; ...</span></pre>

    <p>Params are:</p>

    <ul>
    <li>  <code>name</code> packages would be removed in this local repository</li>
    <li>  <code>package-spec</code> list of <a href="#package-spec">package search conditions</a></li>
    </ul>

    <p>Flags:</p>

    <ul>
      <li>
        <code>-dry-run=false</code>: don't remove, just show what would be removed
      </li>
    </ul>

    <p>When packages are removed from local repository, only references to those packages are removed. If packages are part
    of any snapshot, this action won't remove them from snapshot. If there are no references to the packages, package files
    and metadata could be cleaned up by running command <a href="#aptly-db-cleanup">aptly db cleanup</a>.</p>

    <p>Example:</p>

<pre><span class="greeting">$</span> <span class="command">aptly repo remove stable percona-server-client-5.5</span>
Loading packages...
<span class="red">[-]</span> percona-server-client-5.5_5.5.35-rel33.0-611.squeeze_i386 removed
<span class="red">[-]</span> percona-server-client-5.5_5.5.35-rel33.0-611.squeeze_amd64 removed
</pre>

  <!-- ================ aptly repo edit ============== -->
  <div class="target-spacer" id="aptly-repo-edit"><a name="aptly-repo-edit"></a>&nbsp;</div>
  <h4>Command <code>aptly repo edit</code></h4>

    <p>Command edit allows to change metadata of local repository:
    comment, default distribution and component.</p>

    <p>Usage:</p>

    <pre><span class="greeting">$</span> <span class="command"> aptly repo edit &lt;name&gt;</span></pre>

    <p>Params are:</p>

    <ul>
    <li>  <code>name</code> is a local repository name</li>
    </ul>

    <p>Flags:</p>

    <ul>
      <li>
        <code>-comment=""</code>: any text that would be used to described local repository
      </li>
      <li>
        <code>-component=""</code>: default component when publishing
      </li>
      <li>
        <code>-distribution=""</code>: default distribution when publishing
      </li>
    </ul>

    <p>Default distribution and component would be taken as defaults when publishing repository
    either directly or via snapshots.</p>


    <p>Example:</p>

<pre><span class="greeting">$</span> <span class="command">aptly repo edit -comment="Nightly builds" -distribution=wheezy testing</span>
Local repo [testing]: Nightly builds successfully updated.
</pre>

  <!-- ================ aptly repo drop ============== -->
  <div class="target-spacer" id="aptly-repo-drop"><a name="aptly-repo-drop"></a>&nbsp;</div>
  <h4>Command <code>aptly repo drop</code></h4>

    <p>Drop deletes information about local package repository. Package data is not deleted
      (it could be still used by other mirrors or snapshots). If snapshot has been created from local repository,
      aptly would refuse to delete such repository, use flag <code>-force</code> to override.
    </p>

    <p>Usage:</p>

    <pre><span class="greeting">$</span> <span class="command">aptly repo drop &lt;name&gt;</span></pre>

    <p>Params:</p>

    <ul>
    <li>  <code>name</code> is local repository name</li>
    </ul>

    <p>Flags:</p>

    <ul>
    <li>  <code>-force=false</code>: drop repository even if it used as source of some snapshot</li>
    </ul>

    <div class="alert alert-info">Dropping local repository only removes metadata, in order to cleanup the disk
    space occupied by package files you might need to run <a href="#aptly-db-cleanup"><code>aptly db cleanup</code></a> command.</div>

    <p>Example:</p>

<pre><span class="greeting">$</span> <span class="command">aptly repo drop stable</span>
Local repo `stable` has been removed.</pre>

<!-- ================ aptly snapshot ============== -->
<div class="target-spacer" id="aptly-snapshot"><a name="aptly-snapshot"></a>&nbsp;</div>
<h3>Command <code>snapshot</code></h3>

    <p>Snapshot is a fixed state of remote repository. Internally snapshot is
    list of packages with explicit version. Snapshot is immutable, i.e. it
    can't change since it has been created.</p>

  <!-- ================ aptly snapshot create ============== -->
  <div class="target-spacer" id="aptly-snapshot-create"><a name="aptly-snapshot-create"></a>&nbsp;</div>
  <h4>Command <code>aptly snapshot create .. from mirror</code></h4>

    <p>Creates snapshot from current state of remote mirror. Mirror should be
    updated at least once before running this command.</p>

    <p>Snapshot would contain exactly the same set of packages as mirror currently does.
    Snapshot is immutable, so if mirror is updated, snapshot contents won't change. If mirror
    contains source packages, snapshot would also contain source packages.</p>

    <p>Usage:</p>

    <pre><span class="greeting">$</span> <span class="command">aptly snapshot create &lt;name&gt; from mirror &lt;mirror-name&gt;</span></pre>

    <p>Params are:</p>

    <ul>
    <li>  <code>name</code> is a name for the snapshot to be created</li>
    <li>  <code>mirror-name</code> is a mirror name (given when mirror was created)</li>
    </ul>

    <p>Example:</p>

<pre><span class="greeting">$</span> <span class="command">aptly snapshot create monday-updates from mirror backports2</span>

Snapshot monday-updates successfully created.
You can run 'aptly publish snapshot monday-updates' to publish snapshot as Debian repository.
</pre>

  <div class="target-spacer">&nbsp;</div>
  <h4>Command <code>aptly snapshot create .. from repo</code></h4>

    <p>Creates snapshot from current state of local package repository. Repository
    should contain at least one package.</p>

    <p>Snapshot would contain exactly the same set of packages as local repositorory currently does.
    Snapshot is immutable, so if local repository is changed in any way, snapshot contents won't change.</p>

    <p>Usage:</p>

    <pre><span class="greeting">$</span> <span class="command">aptly snapshot create &lt;name&gt; from repo &lt;repo-name&gt;</span></pre>

    <p>Params are:</p>

    <ul>
    <li>  <code>name</code> is a name for the snapshot to be created</li>
    <li>  <code>repo-name</code> is a local repository name</li>
    </ul>

    <p>Example:</p>

<pre><span class="greeting">$</span> <span class="command">aptly snapshot create snap-stable from repo stable</span>

Snapshot snap-stable successfully created.
You can run 'aptly publish snapshot snap-stable' to publish snapshot as Debian repository.
</pre>


  <div class="target-spacer">&nbsp;</div>
  <h4>Command <code>aptly snapshot create .. empty</code></h4>

    <p>Creates empty snapshot. As snapshots are immutable, creating one empty snapshot should be enough. Empty snapshots
    could be used as first snapshot while pulling packages to create completely defined set of packages.</p>

    <p>Usage:</p>

    <pre><span class="greeting">$</span> <span class="command">aptly snapshot create &lt;name&gt; empty</span></pre>

    <p>Params are:</p>

    <ul>
    <li>  <code>name</code> is a name for the snapshot to be created</li>
    </ul>

    <p>Example:</p>

<pre><span class="greeting">$</span> <span class="command">aptly snapshot create empty-snapshot empty</span>

Snapshot empty-snapshot successfully created.
You can run 'aptly publish snapshot empty-snapshot' to publish snapshot as Debian repository.
</pre>

  <!-- ================ aptly snapshot list ============== -->
  <div class="target-spacer" id="aptly-snapshot-list"><a name="aptly-snapshot-list"></a>&nbsp;</div>
  <h4>Command <code>aptly snapshot list</code></h4>

    <p>Displays list of all created snapshots.</p>

    <p>Usage:</p>

    <pre><span class="greeting">$</span> <span class="command">aptly snapshot list</span></pre>

    <p>Flags:</p>

    <ul>
      <li>
        <code>-raw=false</code>: display list in machine-readable format
        <code>-sort="name"</code>: display list in 'name' or creation 'time' order
      </li>
    </ul>

    <p>Examples:</p>

<pre><span class="greeting">$</span> <span class="command">aptly snapshot list</span>
List of snapshots:
 * [monday-updates]: Snapshot from mirror [backports2]: http://mirror.yandex.ru/backports.org/ squeeze-backports
 * [back]: Snapshot from mirror [backports2]: http://mirror.yandex.ru/backports.org/ squeeze-backports

To get more information about snapshot, run `aptly snapshot show &lt;name&gt;`.
</pre>

    <p>In snapshot list, basic information on snapshot creation way is displayed.</p>

<pre><span class="greeting">$</span> <span class="command">aptly snapshot list -raw</span>
monday-updates
back
</pre>

  <!-- ================ aptly snapshot show ============== -->
  <div class="target-spacer" id="aptly-snapshot-show"><a name="aptly-snapshot-show"></a>&nbsp;</div>
  <h4>Command <code>aptly snapshot show</code></h4>

    <p>Shows detailed information about snapshot. Full list of packages in the
    snapshot is displayed as well.</p>

    <p>Usage:</p>

    <pre><span class="greeting">$</span> <span class="command">aptly snapshot show &lt;name&gt;</span></pre>

    <p>Params:</p>

    <ul>
    <li>  <code>name</code> is snapshot name which has been given during snapshot
    creation</li>
    </ul>

    <p>Flags:</p>

    <ul>
    <li>  <code>-with-packages=false</code>: show detailed list of packages and versions stored in the mirror</li>
    </ul>

    <p>Example:</p>

<pre><span class="greeting">$</span> <span class="command">aptly snapshot show back</span>
Name: back
Created At: 2013-12-24 15:39:29 MSK
Description: Snapshot from mirror [backports2]: http://mirror.yandex.ru/backports.org/ squeeze-backports
Number of packages: 3898
Packages:
  altos-1.0.3~bpo60+1_i386
  amanda-client-1:3.3.1-3~bpo60+1_amd64
  ...
</pre>

  <!-- ================ aptly snapshot verify ============== -->
  <div class="target-spacer" id="aptly-snapshot-verify"><a name="aptly-snapshot-verify"></a>&nbsp;</div>
  <h4>Command <code>aptly snapshot verify</code></h4>

    <p>Verifies dependencies between packages in snapshot <code>&lt;name&gt;</code> and reports
    unsatisfied dependencies. Command might take additional snapshots as dependency
    sources.</p>

    <p>Usage:</p>

    <pre><span class="greeting">$</span> <span class="command">aptly snapshot verify &lt;name&gt; [&lt;source&gt; ...]</span></pre>

    <p>Params:</p>

    <ul>
    <li>  <code>name</code> is snapshot name which has been given during snapshot
    creation</li>
    <li>  <code>source</code> is a optional list of snapshot names which would be used as
    additional sources</li>
    </ul>

    <p>If architectures are limited (with config <code>architectures</code> or option
    <code>-architectures</code>), only mentioned architectures are checked for internal
    dependencies, otherwise <code>aptly</code> will check all architectures in the
    snapshot.</p>

    <p>By using <code>-dep-follow-source</code> global flag you can verify that snapshot has all source packages
    available to re-build packages from source.</p>

    <p>Example:</p>

<pre><span class="greeting">$</span> <span class="command">aptly snapshot verify snap-deb2-main</span>
Missing dependencies (7):
  oracle-instantclient11.2-basic [i386]
  scsh-0.6 [amd64]
  fenix [amd64]
  fenix-plugins-system [amd64]
  mozart (&gt;= 1.4.0) [amd64]
  scsh-0.6 (&gt;= 0.6.6) [amd64]
  oracle-instantclient11.2-basic [amd64]
</pre>

  <!-- ================ aptly snapshot pull ============== -->
  <div class="target-spacer" id="aptly-snapshot-pull"><a name="aptly-snapshot-pull"></a>&nbsp;</div>
  <h4>Command <code>aptly snapshot pull</code></h4>

    <p>Pulls new packages along with its dependencies in <code>name</code> snapshot from
    <code>source</code> snapshot. Also can upgrade package version from one snapshot
    into another, once again along with dependencies. New snapshot
    <code>destination</code> is created as result of this process.</p>

    <p>Usage:</p>

    <pre><span class="greeting">$</span> <span class="command">aptly snapshot pull &lt;name&gt; &lt;source&gt; &lt;destination&gt; &lt;package-name&gt; ...</span></pre>

    <p>Params:</p>

    <ul>
    <li>  <code>name</code> is snapshot name which has been given during snapshot
    creation</li>
    <li>  <code>source</code> is a snapshot name where packages and dependencies would be
    searched</li>
    <li>  <code>destination</code> is a name of the snapshot that would be created</li>
    <li>  <code>package-name</code> is a name of package to be pulled from <code>source</code>,
    could be specified as Debian dependency, e.g. <code>package (&gt;= 1.3.5)</code>
    to restrict search to specific version</li>
    </ul>

    <p>Flags:</p>

    <ul>
    <li>  <code>-all-matches=false</code>: pull all the packages that satisfy the dependency version requirements</li>
    <li>  <code>-dry-run=false</code>: don't create destination snapshot, just show what
    would be pulled</li>
    <li>  <code>-no-deps=false</code>: don't process dependencies, just pull listed
    packages</li>
    <li>  <code>-no-remove=false</code>: don't remove other package versions when pulling package</li>
    </ul>

    <p>If architectures are limited (with config <code>architectures</code> or option
    <code>-architectures</code>), only mentioned architectures are processed, otherwise
    <code>aptly</code> will process all architectures in the snapshot.</p>

    <p>If following dependencies by source is enabled (using either <code>dependencyFollowSource</code> config option or
    flag <code>-dep-follow-source</code>), pulling binary packages would also pull corresponding source packages as well.</p>

    <p>By default aptly would remove packages matching name and architecture while importing: e.g. when importing
    <code>software_1.3_amd64</code>, package <code>software_1.2.9_amd64</code>  would be removed. With flag <code>-no-remove</code>
    both package versions would stay in the snapshot.</p>

    <p>Example:</p>

<pre><span class="greeting">$</span> <span class="command">aptly snapshot pull snap-deb2-main back snap-deb-main-w-xorg xserver-xorg</span>
Dependencies would be pulled into snapshot:
    [snap-deb2-main]: Snapshot from mirror [deb2-main]: http://ftp.ru.debian.org/debian/ squeeze
from snapshot:
    [back]: Snapshot from mirror [backports2]: http://mirror.yandex.ru/backports.org/ squeeze-backports
and result would be saved as new snapshot snap-deb-main-w-xorg.
Loading packages (49476)...
Building indexes...
<span class="red">[-]</span> xserver-xorg-1:7.5+8+squeeze1_amd64 removed
<span class="green">[+]</span> xserver-xorg-1:7.6+8~bpo60+1_amd64 added
<span class="red">[-]</span> xserver-xorg-core-2:1.7.7-16_amd64 removed
<span class="green">[+]</span> xserver-xorg-core-2:1.10.4-1~bpo60+2_amd64 added
<span class="red">[-]</span> xserver-common-2:1.7.7-16_all removed
<span class="green">[+]</span> xserver-common-2:1.10.4-1~bpo60+2_all added
<span class="red">[-]</span> libxfont1-1:1.4.1-3_amd64 removed
<span class="green">[+]</span> libxfont1-1:1.4.4-1~bpo60+1_amd64 added
<span class="red">[-]</span> xserver-xorg-1:7.5+8+squeeze1_i386 removed
<span class="green">[+]</span> xserver-xorg-1:7.6+8~bpo60+1_i386 added
<span class="red">[-]</span> xserver-xorg-core-2:1.7.7-16_i386 removed
<span class="green">[+]</span> xserver-xorg-core-2:1.10.4-1~bpo60+2_i386 added
<span class="red">[-]</span> libxfont1-1:1.4.1-3_i386 removed
<span class="green">[+]</span> libxfont1-1:1.4.4-1~bpo60+1_i386 added

Snapshot snap-deb-main-w-xorg successfully created.
You can run 'aptly publish snapshot snap-deb-main-w-xorg' to publish snapshot as Debian repository.
</pre>

  <!-- ================ aptly snapshot diff ============== -->
  <div class="target-spacer" id="aptly-snapshot-diff"><a name="aptly-snapshot-diff"></a>&nbsp;</div>
  <h4>Command <code>aptly snapshot diff</code></h4>

    <p>Displays difference in packages between two snapshots. Snapshot is a
    list of packages, so difference between snapshots is a difference
    between package lists. Package could be either completely missing in one
    snapshot, or package is present in both snapshots with different
    versions.</p>

    <p>Usage:</p>

    <pre><span class="greeting">$</span> <span class="command">aptly snapshot diff &lt;name-a&gt; &lt;name-b&gt;</span></pre>

    <p>Params:</p>

    <ul>
    <li>  <code>name-a</code> is snapshot name which is "on the left" during comparison</li>
    <li>  <code>name-b</code> is snapshot name which is "on the right" during comparison</li>
    </ul>


    <p>Flags:</p>

    <ul>
    <li>  <code>-only-matching=false</code>: display diff only for matching packages
    (don't display missing packages)</li>
    </ul>

    <p>Example:</p>

<pre><span class="greeting">$</span> <span class="command">aptly snapshot diff snap-deb2-main snap-deb-main-w-xorg</span>
  Arch   | Package                                  | Version in A                             | Version in B
<span class="yellow">!</span> amd64  | libxfont1                                | 1:1.4.1-3                                | 1:1.4.4-1~bpo60+1
<span class="yellow">!</span> i386   | libxfont1                                | 1:1.4.1-3                                | 1:1.4.4-1~bpo60+1
<span class="yellow">!</span> all    | xserver-common                           | 2:1.7.7-16                               | 2:1.10.4-1~bpo60+2
<span class="yellow">!</span> amd64  | xserver-xorg                             | 1:7.5+8+squeeze1                         | 1:7.6+8~bpo60+1
<span class="yellow">!</span> i386   | xserver-xorg                             | 1:7.5+8+squeeze1                         | 1:7.6+8~bpo60+1
<span class="yellow">!</span> amd64  | xserver-xorg-core                        | 2:1.7.7-16                               | 2:1.10.4-1~bpo60+2
<span class="yellow">!</span> i386   | xserver-xorg-core                        | 2:1.7.7-16                               | 2:1.10.4-1~bpo60+2
</pre>

  <!-- ================ aptly snapshot merge ============== -->
  <div class="target-spacer" id="aptly-snapshot-merge"><a name="aptly-snapshot-merge"></a>&nbsp;</div>
  <h4>Command <code>aptly snapshot merge</code></h4>

    <p>Merge merges several snapshots into one. Merge happens from left to right. By default, packages with the same
    name-architecture pair are replaced during merge (package from latest snapshot on the list wins).
    With <code>-latest</code>, package with latest version wins.
    With <code>-no-remove</code> flag, all versions of packages are preserved during merge.
    If only one snapshot is specified, merge copies <code>source</code> into <code>destination</code>.</p>

    <p>Usage:</p>

    <pre><span class="greeting">$</span> <span class="command">aptly snapshot merge &lt;destination&gt; &lt;source&gt; [&lt;source&gt;...]</span></pre>

    <p>Params:</p>

    <ul>
    <li>  <code>destination</code> is a name of the snapshot that would be created</li>
    <li>  <code>source</code> is a list of snapshot names that would be merged together</li>
    </ul>

    <p>Flags:</p>

    <ul>
    <li>  <code>-latest=false</code>: use only the latest version of each package</li>
    <li>  <code>-no-remove=false</code>: don't remove duplicate arch/name packages</li>
    </ul>

    <p>Example:</p>

<pre><span class="greeting">$</span> <span class="command">aptly snapshot merge debian-w-backports debian-main debian-backports</span>

Snapshot debian-w-backports successfully created.
You can run 'aptly publish snapshot debian-w-backports' to publish snapshot as Debian repository.
</pre>

  <!-- ================ aptly snapshot drop ============== -->
  <div class="target-spacer" id="aptly-snapshot-drop"><a name="aptly-snapshot-drop"></a>&nbsp;</div>
  <h4>Command <code>aptly snapshot drop</code></h4>

    <p>Drop removes information about snapshot. If snapshot is published, it can't be dropped (first remove publishing for snapshot).
    If snapshot is used as source for other snapshots (using merge or pull), aptly would refuse to drop such snapshot, use flag
    <code>-force</code> to override this check.
    </p>

    <p>Usage:</p>

    <pre><span class="greeting">$</span> <span class="command">aptly snapshot drop &lt;name&gt;</span></pre>

    <p>Params:</p>

    <ul>
    <li>  <code>name</code> is snapshot name which has been given during snapshot
    creation</li>
    </ul>

    <p>Flags:</p>

    <ul>
    <li>  <code>-force=false</code>: drop snapshot even if it used as source in other snapshots</li>
    </ul>

    <div class="alert alert-info">Dropping snapshot only removes metadata, in order to cleanup the disk
    space occupied by package files you might need to run <a href="#aptly-db-cleanup"><code>aptly db cleanup</code></a> command
    (package files would be removed only if they're not referenced by mirrors and other snapshots anymore).</div>

    <p>Example:</p>

<pre><span class="greeting">$</span> <span class="command">snapshot drop snap-wheezy</span>
Snapshot `snap-wheezy` has been dropped.</pre>

<!-- ================ aptly publish ============== -->
<div class="target-spacer" id="aptly-publish"><a name="aptly-publish"></a>&nbsp;</div>
<h3>Command <code>publish</code></h3>

  <p>Publish snapshot or local repo as Debian repository which could be served by
  HTTP/FTP/rsync server. Repository is signed by user's key with GnuPG.
  Key should be created beforehand (see section GPG Keys). Published
  repository could be consumed directly by apt.</p>

  <!-- ================ GPG Keys ============== -->
  <div class="target-spacer" id="gpg-keys"><a name="gpg-keys"></a>&nbsp;</div>
  <h4>GPG Keys</h4>

    <p>GPG key is required to sign any published repository. Key should be
    generated before publishing first repository.</p>

    <p>Key generation, storage, backup and revocation is out of scope of this
    document, there are many tutorials available, e.g. <a href="http://fedoraproject.org/wiki/Creating_GPG_Keys">this
    one</a>.</p>

    <p>Publiс part of the key should be exported (<code>gpg --export --armor</code>) and
    imported into apt keyring on all machines that would be using published
    repositories using <code>apt-key</code>.</p>

    <p>Signing releases is highly recommended, but if you want to skip it, you can either use
    <code>gpgDisableSign</code> configuration option or <code>--skip-signing</code> flag.</p>


  <!-- ================ aptly publish shapshot ============== -->
  <div class="target-spacer" id="aptly-publish-snapshot"><a name="aptly-publish-snapshot"></a>&nbsp;</div>
  <h4>Command <code>aptly publish snapshot</code></h4>

    <p>Publishes snapshot as repository to be consumed by <code>apt</code>. Published repostiories
     appear under <code>rootDir/public</code> directory. Valid <a href="#gpg-keys">GPG key</a> is required
     for publishing.</p>

    <p>Usage:</p>

    <pre><span class="greeting">$</span> <span class="command">aptly publish snapshot &lt;name&gt; [&lt;prefix&gt;]</span></pre>

    <p>Params:</p>

    <ul>
    <li>  <code>name</code> is a snapshot name that snould be published</li>
    <li>  <code>prefix</code> is an optional prefix for publishing, if not specified,
    repository would be published to the root of publiс directory. <code>prefix</code> could be single directory like
    <code>ppa</code> or part of the tree like <code>ppa/android</code>. <code>prefix</code> shouldn't contain
    <code>..</code>, and names <code>dists</code> and <code>pool</code> are not accepted. Empty <code>prefix</code>
    would be converted to <code>.</code>.</li>
    </ul>

    <p>Flags:</p>

    <ul>
    <li>  <code>-component=""</code>: component name to publish; guessed from original
    repository (if any), or defaults to <code>main</code> (for multi-component publishing,
    separate components with commas)</li>
    <li>  <code>-distribution=""</code>: distribution name to publish; guessed from
    original repository distribution</li>
    <li>  <code>-gpg-key=""</code>: GPG key ID to use when signing the release, if not
    specified default key is used</li>
    <li>  <code>-keyring=""</code>: GPG keyring to use (instead of default)</li>
    <li>  <code>-label=""</code>: value for <code>Label:</code> field</li>
    <li>  <code>-origin=""</code>: value for <code>Origin:</code> field</li>
    <li>  <code>-secret-keyring=""</code>: GPG secret keyring to use (instead of default)</li>
    <li>  <code>-skip-signing=false</code>: don't sign Release files with GPG
    </ul>

    <p>If architectures are limited (with config <code>architectures</code> or option
    <code>-architectures</code>), only mentioned architectures would be published,
    otherwise <code>aptly</code> will publish all architectures in the snapshot.</p>

    <p><code>aptly</code> would try to figure out distribution and component from snapshot by going via
    snapshot source tree down to mirrors and local repositories. If all roots report the same
    distribution name, it is chosen as default. If there are different distribution names or
    distribution name is not specfied, <code>aptly</code> would display an error. For component name
    the same rules apply except in case of not being able to figure out component, aptly would
    use component <code>main</code>.</p>

    <div class="alert alert-info">It is not allowed to publish two snapshots to the same
    <code>prefix</code> and <code>distribution</code>.</div>

    <p>Empty snapshots could be published as well (as placeholder, for subsequent updates using
    <a href="#aptly-publish-switch">aptly publish switch</a> command). When publishing empty
    snapshots it is important to specify complete architectures list (using <code>-architectures</code> flag),
    as it can't be changed after publishing.</p>

    <p>Multiple component repositories should be published from several snapshots, one snapshot
    per component. In case of multiple component publishing, command accepts several snapshot names:</p>

    <pre><span class="greeting">$</span> <span class="command">aptly publish snapshot -component=main,contrib wheezy-main wheezy-contrib</span></pre>

    <p>When mirroring remote repositories in order to preserve package split by component, create
    individual mirrors for each component, take snapshots and publish them as multi-component repository.</p>

    <p>Example:</p>

<pre><span class="greeting">$</span> <span class="command">aptly publish snapshot back</span>
Signing file '/var/aptly/public/dists/squeeze-backports/Release' with gpg, please enter your passphrase when prompted:

&lt;&lt;gpg asks for passphrase&gt;&gt;

Clearsigning file '/var/aptly/public/dists/squeeze-backports/Release' with gpg, please enter your passphrase when prompted:

&lt;&lt;gpg asks for passphrase&gt;&gt;

Snapshot back has been successfully published.
Please setup your webserver to serve directory '/var/aptly/public' with autoindexing.
Now you can add following line to apt sources:
  deb http://your-server/ squeeze-backports main
Don't forget to add your GPG key to apt with apt-key.
</pre>

<p>Directory structure for published repositories:</p>

<ul>
  <li>
    <code>&lt;rootDir&gt;</code>: <a href="#configuration">configuration</a> parameter, defaults to <code>~/.aptly</code>
    <ul>
      <li>
        <code>public/</code>: root of published tree (root for webserver)
        <ul>
          <li>
            <code>dists/</code>
            <ul>
              <li>
                <code>squeeze/</code>: distribution name
                <ul>
                  <li><code>Release</code>: raw file</li>
                  <li><code>InRelease</code>: clearsigned version</li>
                  <li><code>Release.gpg</code>: detached <code>Release</code> signature</li>
                  <li>
                    <code>binary-i386</code>: binary packages index for architecture <code>i386</code>
                    <ul>
                      <li><code>Packages</code>: package metadata</li>
                      <li><code>Packages.gz</code></li>
                      <li><code>Packages.bz2</code></li>
                      <li><code>Release</code>: used by debian-installer</li>
                    </ul>
                  </li>
                  <li>
                    <code>source</code>: source packages index (generated only if source packages are available)
                    <ul>
                      <li><code>Sources</code>: package metadata</li>
                      <li><code>Sources.gz</code></li>
                      <li><code>Sources.bz2</code></li>
                      <li><code>Release</code>: used by debian-installer</li>
                    </ul>
                  </li>
                </ul>
              </li>
            </ul>
          </li>
          <li>
            <code>pool</code>
            <ul>
              <li>
                <code>main/</code>: component main
                <ul>
                  <li>
                    <code>m/</code>
                    <ul>
                      <li>
                        <code>mars-invaders/</code>
                        <ul>
                          <li><code>mars-invaders_1.0.3_i386.deb</code>: package file (hard link to package from main pool)
                        </ul>
                      </li>
                    </ul>
                  </li>
                </ul>
              </li>
            </ul>
          </li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

  <!-- ================ aptly publish repo ============== -->
  <div class="target-spacer" id="aptly-publish-repo"><a name="aptly-publish-repo"></a>&nbsp;</div>
  <h4>Command <code>aptly publish repo</code></h4>

    <p>Publishes local repository directly, bypassing snapshot creation step.
     Published repositories appear under <code>rootDir/public</code> directory.
     Valid <a href="#gpg-keys">GPG key</a> is required for publishing.</p>

    <div class="alert alert-warning">It is not advised to publish local repositories directly
    unless repository is used to host testing versions of packages that change frequently.
    For production usage please <a href="#aptly-snapshot-create">create snapshot</a> from
    repository and <a href="#aptly-publish-snapshot">publish it</a>.</div>

    <p>Usage:</p>

    <pre><span class="greeting">$</span> <span class="command">aptly publish repo &lt;name&gt; [&lt;prefix&gt;]</span></pre>

    <p>Params:</p>

    <ul>
    <li>  <code>name</code> is a local repo name that snould be published</li>
    <li>  <code>prefix</code> is an optional prefix for publishing, if not specified,
    repository would be published to the root of publiс directory. <code>prefix</code> could be single directory like
    <code>ppa</code> or part of the tree like <code>ppa/android</code>. <code>prefix</code> shouldn't contain
    <code>..</code>, and names <code>dists</code> and <code>pool</code> are not accepted. Empty <code>prefix</code>
    would be converted to <code>.</code>.</li>
    </ul>

    <p>Flags:</p>

    <ul>
    <li>  <code>-component=""</code>: component name to publish; it is taken from local
    repository default, otherwise it defaults to <code>main</code> (for multi-component publishing,
    separate components with commas)</li>
    <li>  <code>-distribution=""</code>: distribution name to publish; guessed from
    local repository default distribution</li>
    <li>  <code>-gpg-key=""</code>: GPG key ID to use when signing the release, if not
    specified default key is used</li>
    <li>  <code>-keyring=""</code>: GPG keyring to use (instead of default)</li>
    <li>  <code>-label=""</code>: value for <code>Label:</code> field</li>
    <li>  <code>-origin=""</code>: value for <code>Origin:</code> field</li>
    <li>  <code>-secret-keyring=""</code>: GPG secret keyring to use (instead of default)</li>
    <li>  <code>-skip-signing=false</code>: don't sign Release files with GPG
    </ul>

    <p>If architectures are limited (with config <code>architectures</code> or option
    <code>-architectures</code>), only mentioned architectures would be published,
    otherwise <code>aptly</code> will publish all architectures in the snapshot.</p>

    <div class="alert alert-info">It is not allowed to publish two repositories or snapshots to the same
    <code>prefix</code> and <code>distribution</code>.</div>

    <p>When local repository changes, published repository could be updated in-place
    using command <a href="#aptly-publish-update">aptly publish update</a>.</p>

    <p>Empty local repos could be published as well (as placeholder, for subsequent updates using
    <a href="#aptly-publish-update">aptly publish update</a> command). When publishing empty
    local repos it is important to specify complete architectures list (using <code>-architectures</code> flag),
    as it can't be changed after publishing.</p>

    <p>Multiple component repositories should be published from several local repositories, one repository
    per component. In that case, command accepts several local repositories names:</p>

    <pre><span class="greeting">$</span> <span class="command">aptly publish repo -component=main,contrib mysoft-main mysoft-contrib</span></pre>

    <p>Example:</p>

<pre><span class="greeting">$</span> <span class="command">aptly publish repo local-repo</span>
Signing file '/var/aptly/public/dists/squeeze/Release' with gpg, please enter your passphrase when prompted:

&lt;&lt;gpg asks for passphrase&gt;&gt;

Clearsigning file '/var/aptly/public/dists/squeeze/Release' with gpg, please enter your passphrase when prompted:

&lt;&lt;gpg asks for passphrase&gt;&gt;

Snapshot back has been successfully published.
Please setup your webserver to serve directory '/var/aptly/public' with autoindexing.
Now you can add following line to apt sources:
  deb http://your-server/ squeeze main
Don't forget to add your GPG key to apt with apt-key.
</pre>

  <!-- ================ aptly publish update ============== -->
  <div class="target-spacer" id="aptly-publish-update"><a name="aptly-publish-update"></a>&nbsp;</div>
  <h4>Command <code>aptly publish update</code></h4>

    <p>Command re-publishes (updates) published local repository. <code>distribution</code>
    and <code>prefix</code> should be occupied with local repository published
    using command <a href="#aptly-publish-repo">aptly publish repo</a>. Update happens in-place with
    minimum possible downtime for published repository.
    Valid <a href="#gpg-keys">GPG key</a> is required for publishing.</p>

    <div class="alert alert-info">When published repository is updated, all the options are preserved: distribution,
    component, list of architectures, etc.</div>

    <p>Usage:</p>

    <pre><span class="greeting">$</span> <span class="command">aptly publish update &lt;distribution&gt; [&lt;prefix&gt;]</span></pre>

    <p>Params:</p>

    <ul>
    <li>  <code>distribution</code> is distribution name of published repository</li>
    <li>  <code>prefix</code> is publishing prefix, if not specified, it would default to empty prefix (<code>.</code>).</li>
    </ul>

    <p>Flags:</p>

    <ul>
    <li>  <code>-gpg-key=""</code>: GPG key ID to use when signing the release, if not
    specified default key is used</li>
    <li>  <code>-keyring=""</code>: GPG keyring to use (instead of default)</li>
    <li>  <code>-secret-keyring=""</code>: GPG secret keyring to use (instead of default)</li>
    <li>  <code>-skip-signing=false</code>: don't sign Release files with GPG
    </ul>

    <p>When updating multiple-component published repository, all local repositories are updated
    simultaneously.</p>

    <p>Example:</p>

<pre><span class="greeting">$</span> <span class="command">aptly publish update maverick</span>
Loading packages...
Generating metadata files and linking package files...
Signing file '/var/aptly/public/dists/maverick/Release.tmp' with gpg, please enter your passphrase when prompted:

&lt;&lt;gpg asks for passphrase&gt;&gt;

Clearsigning file '/var/aptly/public/dists/maverick/Release.tmp' with gpg, please enter your passphrase when prompted:

&lt;&lt;gpg asks for passphrase&gt;&gt;

Cleaning up prefix "." component "main"...

Publish for local repo ./maverick [i386, source] publishes {main: [local-repo]} has been successfully updated.
</pre>

  <!-- ================ aptly publish switch ============== -->
  <div class="target-spacer" id="aptly-publish-switch"><a name="aptly-publish-switch"></a>&nbsp;</div>
  <h4>Command <code>aptly publish switch</code></h4>

    <p>Command switches in-place published repository with new snapshot contents. <code>distribution</code>
    and <code>prefix</code> should be occupied with snapshot published
    using command <a href="#aptly-publish-snapshot">aptly publish snapshot</a>. Update happens in-place with
    minimum possible downtime for published repository.
    Valid <a href="#gpg-keys">GPG key</a> is required for publishing.</p>

    <div class="alert alert-info">When published repository is updated, all the options are preserved: distribution,
    component, list of architectures, etc.</div>

    <p>Usage:</p>

    <pre><span class="greeting">$</span> <span class="command">aptly publish switch &lt;distribution&gt; [&lt;prefix&gt;] &lt;new-snapshot&gt;</span></pre>

    <p>Params:</p>

    <ul>
    <li>  <code>distribution</code> is distribution name of published repository</li>
    <li>  <code>prefix</code> is publishing prefix, if not specified, it would default to empty prefix (<code>.</code>).</li>
    <li>  <code>new-snapshot</code> is a snapshot name that snould be re-published</li>
    </ul>

    <p>Flags:</p>

    <ul>
    <li>  <code>-component=""</code>: list of components to update (separate components with commas)</li>
    <li>  <code>-gpg-key=""</code>: GPG key ID to use when signing the release, if not
    specified default key is used</li>
    <li>  <code>-keyring=""</code>: GPG keyring to use (instead of default)</li>
    <li>  <code>-secret-keyring=""</code>: GPG secret keyring to use (instead of default)</li>
    <li>  <code>-skip-signing=false</code>: don't sign Release files with GPG
    </ul>

    <p>When switching published snapshots for multiple component repositories any subset of snapshots
    could be updated, they should be listed on command line with <code>-component</code> flag:</p>

    <pre><span class="greeting">$</span> <span class="command">aptly publish switch -component=main,contrib wheezy wheezy-main wheezy-contrib</span></pre>

    <p>Flag <code>-component</code> could be omitted for single-component published repositories.</p>


    <p>Example:</p>

<pre><span class="greeting">$</span> <span class="command">aptly publish switch wheezy wheezy-7.4</span>
Loading packages...
Generating metadata files and linking package files...
Signing file '/var/aptly/public/dists/wheezy/Release.tmp' with gpg, please enter your passphrase when prompted:

&lt;&lt;gpg asks for passphrase&gt;&gt;

Clearsigning file '/var/aptly/public/dists/wheezy/Release.tmp' with gpg, please enter your passphrase when prompted:

&lt;&lt;gpg asks for passphrase&gt;&gt;

Cleaning up prefix "." component "main"...

Publish for local repo ./wheezy [i386, amd64] publishes {main: [wheezy-7.4]: snapshot from mirror [wheezy]: http://ftp.ru.debian.org/debian/ wheezy} has been successfully updated.
</pre>

  <!-- ================ aptly publish list ============== -->
  <div class="target-spacer" id="aptly-publish-list"><a name="aptly-publish-list"></a>&nbsp;</div>
  <h4>Command <code>aptly publish list</code></h4>

    <p>Lists repositories that have been published with <code>aptly publish snapshot</code>. For each
    repository information about <code>prefix</code> and <code>distribution</code> is listed along
    with <code>component</code> and architecture list. Information about snapshot published is appended
    to published repository description.</p>

    <p>Usage:</p>

    <pre><span class="greeting">$</span> <span class="command">aptly publish list</span></pre>

    <p>Flags:</p>

    <ul>
      <li>
        <code>-raw=false</code>: display list in machine-readable format
      </li>
    </ul>

    <p>Examples:</p>

<pre><span class="greeting">$</span> <span class="command">aptly publish list</span>
Published repositories:
  * ./sq-b [amd64, i386] publishes {main: [back3]: Snapshot from mirror [backports2]: http://mirror.yandex.ru/backports.org/ squeeze-backports}
  * ./squeeze-backports [amd64, i386] publishes {contrib: [back3]: Snapshot from mirror [backports2]: http://mirror.yandex.ru/backports.org/ squeeze-backports}
</pre>

<pre><span class="greeting">$</span> <span class="command">aptly publish list -raw</span>
. sq-b
. squeeze-backports
</pre>

  <!-- ================ aptly publish drop ============== -->
  <div class="target-spacer" id="aptly-publish-drop"><a name="aptly-publish-drop"></a>&nbsp;</div>
  <h4>Command <code>aptly publish drop</code></h4>

    <p>Remove files belonging to published repository. aptly would try to remove as many files
    belonging to this repository as possible. For example, if no other published repositories share
    the same prefix, all files inside prefix would be removed.</p>

    <p>Usage:</p>

    <pre><span class="greeting">$</span> <span class="command">aptly publish drop &lt;distribution&gt; [&lt;prefix&gt;]</span></pre>

    <ul>
    <li>  <code>distribution</code> is a distribution name for published repository (as displayed by <code>aptly publish list</code>).</li>
    <li>  <code>prefix</code> is an optional prefix for publishing, if not specified,
    prefix is considered to be <code>.</code>.</li>
    </ul>

    <p>Example:</p>

<pre><span class="greeting">$</span> <span class="command">aptly publish drop squeeze-backports</span>
Removing /var/aptly/public/dists/squeeze-backports...
Removing /var/aptly/public/pool/contrib...
</pre>

<!-- ================ aptly db ============== -->
<div class="target-spacer" id="aptly-db"><a name="aptly-db"></a>&nbsp;</div>
<h3>Command <code>db</code></h3>

  <p>aptly db subcommands manage aptly's internal metadata database and package pool.</p>

  <!-- ================ aptly db cleanup ============== -->
  <div class="target-spacer" id="aptly-db-cleanup"><a name="aptly-db-cleanup"></a>&nbsp;</div>
  <h4>Command <code>aptly db cleanup</code></h4>

    <p>Database cleanup removes information about unreferenced packages and deletes
    files in the package pool that aren't used by packages anymore. It is a good idea to run this
    command after massive deletion of mirrors/snapshots.</p>

    <p>Usage:</p>

    <pre><span class="greeting">$</span> <span class="command">aptly db cleanup</span></pre>


    <p>Example:</p>

<pre><span class="greeting">$</span> <span class="command">aptly db cleanup</span>
Loading mirrors and snapshots...
Loading list of all packages...
Deleting unreferenced packages (325)...
Building list of files referenced by packages...
Building list of files in package pool...
Deleting unreferenced files (325)...
Disk space freed: 0.27 GiB...
</pre>

  <!-- ================ aptly db recover ============== -->
  <div class="target-spacer" id="aptly-db-recover"><a name="aptly-db-recover"></a>&nbsp;</div>
  <h4>Command <code>aptly db recover</code></h4>

    <p>Database recover does its best to recover database after crash.
    It is recommended to backup DB before running recover. Recover procedures
    ignores all index files and tries to reconstruct them from <code>.sst</code> files.</p>

    <p>Usage:</p>

    <pre><span class="greeting">$</span> <span class="command">aptly db recover</span></pre>


    <p>Example:</p>

<pre><span class="greeting">$</span> <span class="command">aptly db recover</span>
Recovering DB...
</pre>

<!-- ================ aptly serve ============== -->
<div class="target-spacer" id="aptly-serve"><a name="aptly-serve"></a>&nbsp;</div>
<h3>Command <code>serve</code></h3>

  <p>aptly can serve published repositories using its own embedded webserver. This is not recommended for production
     use, but is a quick way to try out published repository.</p>

  <!-- ================ aptly serve ============== -->
  <div class="target-spacer" id="aptly-serve-cmd"><a name="aptly-serve-cmd"></a>&nbsp;</div>
  <h4>Command <code>aptly serve</code></h4>

    <p>Command serve starts embedded HTTP server (not suitable for real production usage) to serve
    contents of public/ subdirectory of aptly's root that contains published repositories. aptly would
    print recommended <code>apt-sources</code> for the currently published repositories. By default aptly
    would listen on port 8080, but this can be changed with flag <code>-listen</code>.</p>

    <p>Usage:</p>

    <pre><span class="greeting">$</span> <span class="command">aptly serve -listen=:8080</span></pre>

    <p>Flags:</p>

    <ul>
    <li>  <code>-listen=":8080"</code>: host:port for HTTP listening</li>
    </ul>

    <p>Example:</p>

<pre><span class="greeting">$</span> <span class="command">aptly serve -listen=127.0.0.1:8765</span>
Serving published repositories, recommended apt sources list:

# ./maverick (main) [amd64, i386] publishes [snap1]: Snapshot from mirror [gnuplot-maverick]: http://ppa.launchpad.net/gladky-anton/gnuplot/ubuntu/ maverick
deb http://127.0.0.1:8765/ maverick main
# debian/maverick (main) [amd64, i386] publishes [snap2]: Snapshot from mirror [gnuplot-maverick]: http://ppa.launchpad.net/gladky-anton/gnuplot/ubuntu/ maverick
deb http://127.0.0.1:8765/debian/ maverick main

Starting web server at: 127.0.0.1:8765 (press Ctrl+C to quit)...
</pre>


<!-- ================ aptly graph ============== -->
<div class="target-spacer" id="aptly-graph"><a name="aptly-graph"></a>&nbsp;</div>
<h3>Command <code>graph</code></h3>

  <p>aptly generates graph showing depedencies between mirrors, snapshots and published repositories.</p>

  <!-- ================ aptly graph ============== -->
  <div class="target-spacer" id="aptly-graph-cmd"><a name="aptly-graph-cmd"></a>&nbsp;</div>
  <h4>Command <code>aptly graph</code></h4>

    <p>Command graph generates graph of dependencies between snapshots and (what mirrors were used
    to create each snapshots), between snapshots (pulling, merging, etc.) and between snapshots and
    published repositories (how snapshots were published). Graph is rendered to PNG file using
    graphviz package.</p>

    <p>Usage:</p>

    <pre><span class="greeting">$</span> <span class="command">aptly graph</span></pre>


    <p>Example:</p>

    <p><a href="graphfull.png"><img class="img-responsive" alt="Example graph from aptly graph" src="graph.png"></a></p>


<!-- ================ history ============== -->
<div class="target-spacer" id="history"><a name="history"></a>&nbsp;</div>
<h2>History</h2>


  <h3>Version 0.6</h3>

  <ul>
    <li>support for multi-component published repositories (<a href="https://github.com/smira/aptly/issues/36">#36</a>)</li>
    <li>handling duplicate packages with different content gracefully (<a href="https://github.com/smira/aptly/issues/60">#60</a>)</li>
    <li>repositories published by aptly now can be consumed by debian-installer (<a href="https://github.com/smira/aptly/issues/61">#61</a>)</li>
    <li>new flag: <code>-no-remove</code> for <a href="#aptly-snapshot-merge">aptly snapshot merge</a> to merge snapshots with all package versions preserved (<a href="https://github.com/smira/aptly/issues/57">#57</a>)</li>
    <li>publishing of empty snapshots/repositories is possible (<a href="https://github.com/smira/aptly/issues/55">#55</a>)</li>
    <li><a href="#aptly-repo-add">aptly repo add</a> now exits with 1 if any of files failed to add (<a href="https://github.com/smira/aptly/issues/53">#53</a>)</li>
    <li>bug fix: <code>Package:</code> line comes first in package metadata (<a href="https://github.com/smira/aptly/issues/49">#49</a>)</li>
    <li>bug fix: when command parsing fails, aptly returns exit code 2 (<a href="https://github.com/smira/aptly/issues/52">#52</a>)</li>
    <li>bug fix: pulling more than 128 packates at once (<a href="https://github.com/smira/aptly/issues/53">#53</a>)</li>
    <li>bug fix: <a href="#aptly-graph">aptly graph</a> may get confused with package pull requests (<a href="https://github.com/smira/aptly/issues/58">#58</a>)</li>
  </ul>


  <h3>Version 0.5.1</h3>

  <ul>
    <li>bug fix: <code>HTTP_PROXY</code> environment variable has been ignored (<a href="https://github.com/smira/aptly/issues/46">#46</a>)</li>
    <li>bug fix: support for flat repositories in subdirectory (<a href="https://github.com/smira/aptly/issues/47">#47</a>)</li>
    <li>bug fix: wrong pool directory name when <code>Source:</code> contains version (<a href="https://github.com/smira/aptly/issues/44">#44</a>)</li>
  </ul>

  <h3>Version 0.5</h3>

  <ul>
    <li>Debian packages for aptly are <a href="#download">available</a></li>
    <li>internal DB is compacted when calling <a href="#aptly-db-cleanup">aptly db cleanup</a> (<a href="https://github.com/smira/aptly/issues/19">#19</a>)</li>
    <li>size is shown in human-readable format (<a href="https://github.com/smira/aptly/issues/18">#18</a>)</li>
    <li>fixed wrong location of man page in Debian package (<a href="https://github.com/smira/aptly/issues/22">#22</a>)</li>
    <li>new flags: <code>-distribution</code> and <code>-component</code> to specify default publishing options in <a href="#aptly-repo-create">aptly repo create</a> (<a href="https://github.com/smira/aptly/issues/12">#12</a>)</li>
    <li>aptly would try harder to figure out distribution &amp; component automatically when publishing going through the tree of snapshots, mirrors and local repositories</li>
    <li>aptly supports publishing local repositories, without intermediate snapshot step (<a href="https://github.com/smira/aptly/issues/10">#10</a>)</li>
    <li>new command: <a href="#aptly-publish-repo">aptly publish repo</a> to publish local repository directly (<a href="https://github.com/smira/aptly/issues/10">#10</a>)</li>
    <li>new command: <a href="#aptly-repo-edit">aptly publish edit</a> to change defaults for the local repository (<a href="https://github.com/smira/aptly/issues/12">#12</a>)</li>
    <li>aptly supports global &amp; command flags placement in any position in command line (before command name, after command name) (<a href="https://github.com/smira/aptly/issues/17">#17</a>)</li>
    <li>new command: <a href="#aptly-db-recover">aptly db recover</a> to recover internal DB after crash (<a href="https://github.com/smira/aptly/issues/25">#25</a>)</li>
    <li>new flag: <code>-raw</code> to display list in machine-readable format for commands <a href="#aptly-mirror-list">aptly mirror list</a>, <a href="#aptly-repo-list">aptly repo list</a>, <a href="#aptly-snapshot-list">aptly snapshot list</a> and <a href="#aptly-publish-list">aptly publish list</a> (<a href="https://github.com/smira/aptly/issues/27">#27</a>, <a href="https://github.com/smira/aptly/issues/31">#31</a>)</li>
    <li>new flags: <code>-origin</code> and <code>-label</code> to customize fields <code>Origin:</code> and <code>Label:</code> in <code>Release</code> files during publishing in commands <a href="#aptly-publish-snapshot">aptly publish snapshot</a> and <a href="#aptly-publish-repo">aptly publish repo</a> (<a href="https://github.com/smira/aptly/issues/29">#29</a>)</li>
    <li>bug fix: with some HTTP servers aptly might have given "size mismatch" errors due to unnecessary decompression (<a href="https://github.com/smira/aptly/issues/33">#33</a>)</li>
    <li>new command: <a href="#aptly-publish-update">aptly publish update</a> updates published repo in-place (<a href="https://github.com/smira/aptly/issues/8">#8</a>)</li>
    <li>new command: <a href="#aptly-publish-switch">aptly publish switch</a> switches published snapshot in-place (<a href="https://github.com/smira/aptly/issues/8">#8</a>)</li>
    <li>new flag: <code>-latest</code> for command <a href="#aptly-snapshot-merge">aptly snapshot merge</a> changes merge strategy to "latest version wins" (<a href="https://github.com/smira/aptly/pull/42">#42</a>), thanks to <a href="https://github.com/ryanuber">@ryanuber</a> and <a href="https://github.com/keithchambers">@keithchambers</a></li>
</ul>

  <h3>Version 0.4.1</h3>

  <ul>
    <li>fixed <a href="https://github.com/smira/aptly/issues/5">bug</a> with slashes in component names</li>
  </ul>

  <h3>Version 0.4</h3>

  <ul>
    <li>new command: <a href="#aptly-db-cleanup">aptly db cleanup</a> to remove unreferenced DB entries and files</li>
    <li>new flags: <code>-keyring</code> &amp; <code>-secret-keyring</code> for <a href="#aptly-snapshot-publish">aptly snapshot publish</a> command</li>
    <li>aptly supports mirroring remote repos with source packages and publishing repositories with sources</li>
    <li>new config: <code>downloadSourcePackages</code> to enable source package downloading</li>
    <li>new flag: <code>-with-sources</code> for <a href="#aptly-mirror-create">aptly mirror create</a> command</li>
    <li>new config &amp; flag: <code>dependencyFollowSource</code> &amp; <code>-dep-follow-source</code> to follow <code>Source:</code> dependencies</li>
    <li>packages are printed in lists with underscores instead of dashes, e.g. <code>pkg_1.3-3_amd64</code> instead of <code>pkg-1.3-3-amd64</code></li>
    <li>local package repositories are supported</li>
    <li>new commands in <code>aptly repo</code> family: <a href="#aptly-repo-add">add</a>, <a href="#aptly-repo-copy">copy</a>, <a href="#aptly-repo-create">create</a>, <a href="#aptly-repo-drop">drop</a>, <a href="#aptly-repo-import">import</a>, <a href="#aptly-repo-list">list</a>, <a href="#aptly-repo-move">move</a>, <a href="#aptly-repo-remove">remove</a> and <a href="#aptly-repo-show">show</a></li>
    <li>command <a href="#aptly-snapshot-create">aptly snapshot create</a> supports creation of snapshots from local repos</li>
    <li>aptly peak memory usage has been reduced by factor of 3x</li>
    <li>new flag <code>-no-remove</code> for <a href="#aptly-snapshot-pull">aptly snapshot pull</a>: don't remove other version of packages
        when pulling (e.g. keep old versions)</li>
    <li>command <a href="#aptly-mirror-create">aptly mirror create</a> supports shorthand PPA url: <code>ppa:user/project</code></li>
    <li>new config: <code>ppaDistributorID</code> &amp; <code>ppaCodename</code> to specify PPA url expansion rules</li>
  </ul>

  <h3>Version 0.3</h3>

  <ul>
    <li><code>aptly snapshot show</code> doesn't show list of packages by default</li>
    <li>option <code>-with-packages</code> to show list of packages stored in mirror and snapshot</li>
    <li><a href="https://github.com/aptly-dev/aptly-bash-completion">bash completion</a> is now available for aptly</li>
    <li>dropping <a href="#aptly-snapshot-drop">snapshots</a> and <a href="#aptly-mirror-drop">mirrors</a> is supported</li>
    <li><a href="#aptly-serve">serving</a> published repositories</li>
    <li>aptly does checksum validation when downloading from remote mirrors</li>
    <li>aptly verifies crypto signature on Release files</li>
    <li>aptly can create empty snapshots</li>
    <li>new global flag <code>-config</code> to override default config location</li>
    <li>Debian flat repositories are now supported</li>
    <li>command <a href="#aptly-graph">aptly graph</a> can generate graph of dependencies</li>
  </ul>


        <div class="footer">
           <p>&copy; Andrey Smirnov 2014</p>
       </div>
    </div>
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="http://code.jquery.com/jquery-1.11.0.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="js/bootstrap.min.js"></script>

    <!-- Google Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-6065617-2', 'aptly.info');
    ga('send', 'pageview');

    </script>

    <script type="text/javascript">
    (function(doc, script) {
      var js,
          fjs = doc.getElementsByTagName(script)[0],
          frag = doc.createDocumentFragment(),
          add = function(url, id) {
              if (doc.getElementById(id)) {return;}
              js = doc.createElement(script);
              js.src = url;
              id && (js.id = id);
              frag.appendChild( js );
          };

        // Google+ button
        add('http://apis.google.com/js/plusone.js');
        // Facebook SDK
        add('//connect.facebook.net/en_US/all.js#xfbml=1', 'facebook-jssdk');
        // Twitter SDK
        add('//platform.twitter.com/widgets.js');

        fjs.parentNode.insertBefore(frag, fjs);
    }(document, 'script'));
    </script>
  </body>
</html>
